# MISC

## å‰ç½®çŸ¥è¯†

### è¯­è¨€åŸºç¡€
> éœ€è¦å­¦ä¹  python linux  
> é€šå¸¸ä½¿ç”¨pythonç¼–å†™è„šæœ¬ï¼Œå¦‚æœæ²¡æœ‰å­¦ä¹ è¿‡å¯èƒ½æ— æ³•æ·±å…¥çš„å­¦ä¹ åç»­çš„çŸ¥è¯†  
> è§£é¢˜ä¼šä½¿ç”¨linuxçš„ä¸€äº›å·¥å…·ï¼Œé€šå¸¸ä¼šæ­é…å‘½ä»¤
>

### python 
> å‰æœŸå­¦ä¹ åˆ°å‡½æ•°å°±å¤Ÿç”¨ï¼Œå¯¼åŒ…ï¼Œå˜é‡ æ•°æ®ç±»å‹ å¾ªç¯ æ•°ç»„ å­—å…¸ å‡½æ•°...
>

### linuxåŸºç¡€
> å¸¸ç”¨å‘½ä»¤ï¼š
>
> cd ls strings | grep cat file vim mkdir 
>

### ç¼–ç  
> base æ …æ  ç»´å‰å°¼äºš å‡¯æ’’ç­‰
>

### å·¥å…·
> 010 binwalk foremost zsteg å°é²¨é±¼ volç­‰
>

## MISCæ˜¯ä»€ä¹ˆ

### å¸¸è§é¢˜å‹
> éšå†™ ç¼–ç è½¬æ¢ zipç ´è§£ æµé‡åˆ†æ
>

### ......

## å¸¸è§ç¼–ç /åŠ å¯†

### ç¼–ç 
éœ€è¦è®°å¿†å¸¸è§çš„ç¼–ç /åŠ å¯†ç‰¹å¾ï¼Œæé«˜è§£é¢˜é€Ÿåº¦ï¼Œä¸€çœ¼é¡¶é’ˆ

#### baseå®¶æ—
**ä¸¾ä¾‹ï¼š**

> base16             flag         666C6167  
> base32[A-Z2-7]     flag         MZWGCZY=  
> base36             flag         727432  
> base58             flag         3cr9Ae  
> base64             flag         Zmxh  
> base85             flag         Ao(mg  
> base91             flag         @iH<Z  
> base92             flag         F#S<I  
> base100            flag         ğŸ‘ğŸ‘£ğŸ‘˜ğŸ‘  
> base2048           flag         Ú¥ÚŠ×°  
> base65535          flag         ê¦é±¡
>

**ç‰¹å¾ï¼š**

> **Base16ç¼–ç æ˜¯å°†äºŒè¿›åˆ¶æ–‡ä»¶è½¬æ¢æˆç”±16ä¸ªå­—ç¬¦ç»„æˆçš„æ–‡æœ¬ **
>
> ****
>
> **base32çš„ç¼–ç è¡¨æ˜¯ç”±ï¼ˆA-Zã€2-7ï¼‰32ä¸ªå¯è§å­—ç¬¦æ„æˆï¼Œâ€œ=â€ç¬¦å·ç”¨ä½œåç¼€å¡«å……ã€‚**
>
> ****
>
> **base64çš„ç¼–ç è¡¨æ˜¯ç”±ï¼ˆA-Zã€a-zã€0-9ã€+ã€/ï¼‰64ä¸ªå¯è§å­—ç¬¦æ„æˆï¼Œâ€œ=â€ç¬¦å·ç”¨ä½œåç¼€å¡«å……ã€‚**
>
> ****
>
> **base58çš„ç¼–ç è¡¨ç›¸æ¯”base64å°‘äº†æ•°å­—0ï¼Œå¤§å†™å­—æ¯Iï¼ŒOï¼Œå°å†™å­—æ¯ l (è¿™ä¸ªæ˜¯Lï¼‰ï¼Œä»¥åŠç¬¦å·â€˜+â€™å’Œâ€˜/â€™**
>
> ****
>
> **base91çš„å¯†æ–‡ç”±91ä¸ªå­—ç¬¦ï¼ˆ0-9ï¼Œa-zï¼ŒA-Z,!#$%&()*+,./:;<=>?@[]^_`{|}~â€ï¼‰ç»„æˆ**
>
> ****
>
> **Base100ç¼–ç /è§£ç å·¥å…·ï¼ˆåˆåï¼šEmojiè¡¨æƒ…ç¬¦å·ç¼–ç /è§£ç ï¼‰ï¼Œå¯å°†æ–‡æœ¬å†…å®¹ç¼–ç ä¸ºEmojiè¡¨æƒ…ç¬¦å·ï¼›åŒæ—¶ä¹Ÿå¯ä»¥å°†ç¼–ç åçš„Emojiè¡¨æƒ…ç¬¦å·å†…å®¹è§£ç ä¸ºæ–‡æœ¬ã€‚ **
>

å¸¸è§çš„ç†Ÿè®°ï¼Œä¸å¸¸è§çš„é‡åˆ°äº†å¯ä»¥é€šè¿‡è„šæœ¬å’Œå·¥å…·è¯†åˆ«è§£ç 

#### <font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">ASCII</font>
<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">ASCII ç æ˜¯å¯¹</font>**<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">è‹±è¯­å­—ç¬¦ä¸äºŒè¿›åˆ¶ä½ä¹‹é—´</font>**<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">çš„å…³ç³»ï¼Œåšäº†ç»Ÿä¸€è§„å®šã€‚</font>

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">ASCII å­—ç¬¦é›†å…±æœ‰ 128 ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­æœ‰ 96 ä¸ªå¯æ‰“å°å­—ç¬¦ï¼ŒåŒ…æ‹¬å¸¸ç”¨çš„å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹ç¬¦å·</font>

**<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">ä¾‹å¦‚ï¼š</font>**

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">æ•°å­—0ä¸º48(äºŒè¿›åˆ¶ï¼š00110000)</font>

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">å¤§å†™å­—æ¯Aä¸º65ï¼ˆäºŒè¿›åˆ¶ï¼š01000001ï¼‰</font>

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">å¦å¤–è¿˜æœ‰32ä¸ªæ§åˆ¶å­—ç¬¦ï¼ˆä¸èƒ½æ‰“å°å‡ºæ¥ï¼‰</font>

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">è¿™128ä¸ªç¬¦å·ï¼Œåªå ç”¨äº†ä¸€ä¸ªå­—èŠ‚çš„åé¢7ä½ï¼Œæœ€å‰é¢çš„ä¸€ä½ç»Ÿä¸€è§„å®šä¸º0ã€‚</font>

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);"></font>**<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">ç‰¹å¾ï¼š</font>**<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);"> </font>**<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">åªå«æœ‰æ•°å­—</font>**

+ <font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">0-9, 49-57</font>
+ <font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">A-Z, 65-90</font>
+ <font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">a-z, 97-122</font>

**<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">ä¸¾ä¾‹ï¼š</font>**

> æ˜æ–‡ï¼šflag  
> åå…­è¿›åˆ¶ï¼š66 6c 61 67  
> åè¿›åˆ¶ï¼š102 108 97 103  
> å…«è¿›åˆ¶ï¼š146 154 141 147  
> äºŒè¿›åˆ¶ï¼š1100110 1101100 1100001 1100111
>

#### <font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">unicode</font>
> flag: \u0066\u006c\u0061\u0067
>

#### <font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">url</font>
> flag %66%6c%61%67****
>

#### <font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">æ‘©æ–¯ç”µç </font>
> flag  ..-. .-.. .- --.
>

#### <font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">HEX</font>
> flag 666c6167
>

#### <font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">tap code</font>
> flag 21311122
>

æœ€åæˆ‘ä»¬è¦ç†è§£ç¼–ç å’ŒåŠ å¯†çš„åŒºåˆ«

> ç¼–ç   
> ç›®çš„ï¼šç¼–ç çš„ä¸»è¦ç›®çš„æ˜¯å°†æ•°æ®è½¬æ¢ä¸ºå¦ä¸€ç§å½¢å¼ï¼Œä»¥ä¾¿äºå­˜å‚¨ã€ä¼ è¾“æˆ–å¤„ç†ã€‚å®ƒç¡®ä¿æ•°æ®èƒ½å¤Ÿåœ¨ä¸åŒçš„ç³»ç»Ÿæˆ–è®¾å¤‡ä¹‹é—´æ­£ç¡®ç†è§£å’Œä½¿ç”¨ã€‚  
> ç‰¹ç‚¹ï¼š  
>   â—‹ å¯é€†æ€§ï¼šç¼–ç é€šå¸¸æ˜¯å¯é€†çš„ï¼Œå¯ä»¥é€šè¿‡è§£ç æ¢å¤åŸå§‹æ•°æ®ã€‚  
>   â—‹ å…¼å®¹æ€§ï¼šç¡®ä¿æ•°æ®åœ¨ä¸åŒç³»ç»Ÿé—´çš„å…¼å®¹æ€§ï¼Œä¾¿äºä¼ è¾“å’Œå¤„ç†ã€‚  
> åŠ å¯†  
> ç›®çš„ï¼šåŠ å¯†çš„ä¸»è¦ç›®çš„æ˜¯ä¿æŠ¤æ•°æ®çš„æœºå¯†æ€§å’Œå®‰å…¨æ€§ï¼Œé˜²æ­¢æœªç»æˆæƒçš„è®¿é—®æˆ–ç¯¡æ”¹ã€‚åŠ å¯†æ•°æ®éœ€è¦å¯†é’¥æ‰èƒ½è§£å¯†ï¼Œç¡®ä¿åªæœ‰åˆæ³•ç”¨æˆ·èƒ½å¤Ÿè¯»å–æ•°æ®ã€‚  
> å¸¸è§åŠ å¯†ç±»å‹ï¼š  
>   â—‹ å¯¹ç§°åŠ å¯†ï¼šä½¿ç”¨ç›¸åŒçš„å¯†é’¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œé€Ÿåº¦å¿«ï¼Œå¦‚AESã€‚  
>   â—‹ éå¯¹ç§°åŠ å¯†ï¼šä½¿ç”¨å…¬é’¥å’Œç§é’¥ï¼Œå¦‚RSAï¼Œç”¨äºå®‰å…¨é€šä¿¡å’Œæ•°å­—ç­¾åã€‚  
>   â—‹ å“ˆå¸Œå‡½æ•°ï¼šå¦‚MD5ã€SHA-1ï¼Œç”Ÿæˆå›ºå®šé•¿åº¦çš„æ‘˜è¦ï¼Œå•å‘ä¸å¯é€†ï¼Œå¸¸ç”¨äºæ•°æ®å®Œæ•´æ€§éªŒè¯ã€‚  
> ç‰¹ç‚¹ï¼š  
>   â—‹ å®‰å…¨æ€§ï¼šåŠ å¯†ç¡®ä¿æ•°æ®åœ¨ä¼ è¾“æˆ–å­˜å‚¨ä¸­çš„å®‰å…¨æ€§ï¼Œé˜²æ­¢è¢«çªƒå–æˆ–ç¯¡æ”¹ã€‚  
>   â—‹ å¯†é’¥ä¾èµ–ï¼šåŠ å¯†å’Œè§£å¯†é€šå¸¸éœ€è¦å¯†é’¥ï¼Œåªæœ‰åˆæ³•ç”¨æˆ·æ‰èƒ½è®¿é—®ã€‚  
>
> ç›®çš„ä¸åŒï¼šç¼–ç ç”¨äºæ•°æ®çš„è¡¨ç¤ºå’Œä¼ è¾“ï¼ŒåŠ å¯†ç”¨äºæ•°æ®çš„å®‰å…¨ä¿æŠ¤ã€‚  
> å¯é€†æ€§ï¼šç¼–ç é€šå¸¸æ˜¯å¯é€†çš„ï¼Œè€ŒåŠ å¯†éœ€è¦å¯†é’¥æ‰èƒ½è§£å¯†ï¼Œç¡®ä¿æ•°æ®ä»…è¢«æˆæƒè®¿é—®ã€‚  
> åº”ç”¨åœºæ™¯ï¼šç¼–ç å¸¸è§äºæ•°æ®ä¼ è¾“å’Œå­˜å‚¨ï¼ŒåŠ å¯†ç”¨äºä¿æŠ¤æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚å¯†ç ã€æ”¯ä»˜ä¿¡æ¯ç­‰ã€‚
>

### å¤å…¸å¯†ç 

#### å•è¡¨
> å•è¡¨å¯†ç ï¼ˆMonoalphabetic Cipherï¼‰æ˜¯ä¸€ç§æœ€ç®€å•çš„æ›¿æ¢å¯†ç ï¼Œé€šè¿‡å•ä¸€å›ºå®šçš„æ›¿æ¢è¡¨å°†æ˜æ–‡å­—æ¯æ˜ å°„ä¸ºå¯†æ–‡å­—æ¯ã€‚å¯†é’¥ä¸ºæ›¿æ¢è§„åˆ™æœ¬èº«ï¼ŒåŠ å¯†è¿‡ç¨‹ä¸­æ¯ä¸ªæ˜æ–‡å­—æ¯å§‹ç»ˆå¯¹åº”åŒä¸€å¯†æ–‡å­—æ¯ã€‚  
> ç¤ºä¾‹ï¼šå‡¯æ’’å¯†ç ï¼ˆCaesar Cipherï¼‰  
> åŠ å¯†è§„åˆ™ï¼šå°†æ˜æ–‡å­—æ¯å‘å³ç§»åŠ¨å›ºå®šä½æ•°ï¼ˆå¦‚ 3 ä½ï¼‰
>
> ä¾‹å¦‚ï¼š  
> æ˜æ–‡ï¼šA â†’ å¯†æ–‡ï¼šDï¼ŒB â†’ Eï¼Œâ€¦ï¼ŒZ â†’ Cã€‚  
> å¯†é’¥ï¼šç§»åŠ¨ä½æ•°ï¼ˆå¦‚ 3ï¼‰ã€‚  
> ç‰¹ç‚¹ï¼šæ›¿æ¢è§„åˆ™å›ºå®šï¼ŒåŒä¸€æ˜æ–‡å­—æ¯å§‹ç»ˆç”Ÿæˆç›¸åŒå¯†æ–‡å­—æ¯ã€‚
>

#### å¤šè¡¨
> å¤šè¡¨å¯†ç ï¼ˆPolyalphabetic Cipherï¼‰ä½¿ç”¨å¤šä¸ªæ›¿æ¢è¡¨ï¼Œæ ¹æ®å¯†é’¥åŠ¨æ€é€‰æ‹©ä¸åŒçš„æ›¿æ¢è§„åˆ™ï¼ŒåŒä¸€æ˜æ–‡å­—æ¯åœ¨ä¸åŒä½ç½®å¯èƒ½è¢«æ›¿æ¢ä¸ºä¸åŒå¯†æ–‡å­—æ¯ã€‚  
> ç¤ºä¾‹ï¼šç»´å‰å°¼äºšå¯†ç ï¼ˆVigenÃ¨re Cipherï¼‰  
> åŠ å¯†è§„åˆ™ï¼šä»¥å¯†é’¥çŸ­è¯­ï¼ˆå¦‚ â€œKEYâ€ï¼‰ä¸ºå‘¨æœŸï¼Œæ¯ä¸ªæ˜æ–‡å­—æ¯æ ¹æ®å¯†é’¥å¯¹åº”ä½ç½®çš„å­—æ¯ç¡®å®šæ›¿æ¢è¡¨
>
> ä¾‹å¦‚ï¼š  
> æ˜æ–‡ï¼šHELLOï¼Œå¯†é’¥ï¼šKEYï¼ˆé•¿åº¦ 3ï¼‰ï¼Œåˆ™åˆ†ç»„ä¸º â€œHELâ€â€œLOâ€ï¼Œå¯¹åº”å¯†é’¥ â€œKEYâ€â€œKEâ€ã€‚  
> æ¯ä¸ªå­—æ¯æŒ‰å¯†é’¥å­—æ¯åœ¨å­—æ¯è¡¨ä¸­çš„åç§»é‡åŠ å¯†ï¼ˆå¦‚ H + K çš„åç§»é‡ = H+10=Rï¼‰ã€‚  
> å¯†é’¥ï¼šä»»æ„é•¿åº¦çš„çŸ­è¯­æˆ–åºåˆ—ï¼Œå¯†é’¥é•¿åº¦å†³å®šå‘¨æœŸã€‚
>
>
>
> æ¨èä¸€ä¸ªå¯†ç ç ´è§£ç½‘ç«™
>
> [https://www.guballa.de/vigenere-solver](https://www.guballa.de/vigenere-solver)
>

#### ......

### md5
<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">MD5å€¼æ˜¯ç”±32ä½ç”±æ•°å­—â€œ0-9â€å’Œå­—æ¯â€œa-fâ€æ‰€ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œå­—æ¯å¤§å°å†™ç»Ÿä¸€</font>

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">16ä½å€¼æ˜¯å–çš„æ˜¯8~24ä½ã€‚</font>

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);"></font>**<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">ç‰¹å¾ï¼š</font>**

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">æœ‰å›ºå®šé•¿åº¦ï¼Œä¸€èˆ¬æ˜¯32ä½æˆ–è€…16ä½</font>

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">ç”±æ•°å­—â€œ0-9â€å’Œå­—æ¯â€œa-fâ€ç»„æˆ</font>

**<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">ä¸¾ä¾‹ï¼š</font>**

> æ˜æ–‡ï¼šflag  
> md5(32) = 327a6c4304ad5938eaf0efb6cc3e53dc  
> md5(16) = 04ad5938eaf0efb6
>

## éšå†™ç±»è§£é¢˜åˆ†æ

### é€šç”¨æ€è·¯
> ### å„ç±»æ–‡ä»¶å¤´ï¼š
> é¢˜ç›®å¯èƒ½å°†æ–‡ä»¶çš„æ–‡ä»¶å¤´å»æ‰è¿™å°±éœ€è¦æˆ‘ä»¬è¡¥å…¨æ–‡ä»¶å¤´ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ–‡ä»¶å¤´å°¾ç¡®å®šæ–‡ä»¶ç±»å‹ï¼Œåˆ†ç¦»åµŒå…¥æ–‡ä»¶
>
>
>
> zip æ–‡ä»¶å¤´ï¼š50 4B 03 04 14 00 08 00  
> rar æ–‡ä»¶å¤´ï¼š52 61 72 21 (Rar!)               æ–‡ä»¶å°¾ï¼šC4 3D 7B 00 40 07 00  
> 7z  æ–‡ä»¶å¤´ï¼š37 7A BC AF 27 1C  
>
> png æ–‡ä»¶å¤´ï¼š89504E47 0D0A1A0A    
>
> æ–‡ä»¶å°¾ï¼š00000000 49454E44 AE426082  
> jpg æ–‡ä»¶å¤´ï¼šFF D8 FF E0  
>
> æ–‡ä»¶å°¾ï¼šFF D9  
> gif æ–‡ä»¶å¤´ï¼š47 49 46 38 
>
> æ–‡ä»¶å°¾ï¼š00 3B  
> bmp æ–‡ä»¶å¤´ï¼š42 4D
>
>
> mp3 æ–‡ä»¶å¤´ï¼š49 44 33 03 00 00 00 00  
> wav æ–‡ä»¶å¤´ï¼š57 41 56 45   
>
> pyc æ–‡ä»¶å¤´ï¼š03 F3 0D 0A  
> xml æ–‡ä»¶å¤´ï¼š3C 3F 78 6D 6C  
> html æ–‡ä»¶å¤´ï¼š68 74 6D 6C 3E  
> pdf æ–‡ä»¶å¤´ï¼š255044462D312E
>

å¯ä»¥ä½¿ç”¨pythonåº“ magicè¯†åˆ«æ–‡ä»¶ç±»å‹

```python
import magic

# å®‰è£…  pip install python-magic-bin==0.4.14
# print(magic.from_buffer(open('guess', 'rb').read(2048), mime=True))  è§£å†³ä¸­æ–‡æŠ¥é”™

m = magic.Magic()
file_path = "guess"
file_type = m.from_file(file_path)
print(file_type) 

# è¾“å‡º PNG image data, 835 x 706, 8-bit/color RGBA, non-interlaced

# å®˜æ–¹ç¤ºä¾‹ï¼š
"""
magic is a wrapper around the libmagic file identification library.

See README for more information.

Usage:

>>> import magic
>>> magic.from_file("testdata/test.pdf")
'PDF document, version 1.2'
>>> magic.from_file("testdata/test.pdf", mime=True)
'application/pdf'
>>> magic.from_buffer(open("testdata/test.pdf").read(1024))
'PDF document, version 1.2'
>>>


"""
```

**grepç”¨æ³•ï¼š**

```shell
grep -E "å…³é”®è¯1|å…³é”®è¯2|å…³é”®è¯3" æ–‡ä»¶å
æ­é…strings/cat
strings filename | grep -E "å…³é”®è¯1|å…³é”®è¯2|å…³é”®è¯3"
cat pass.txt | grep -E "pass|key"
è¾“å‡ºï¼š
:~/misc# cat pass.txt | grep -E "pass|key"
pass
key
pass
```

**exif:**

> **å¯èƒ½ä¼šå°†flag/password/key/init æ”¾åœ¨exifé‡Œé¢å¸¸è§åœ¨jpgé‡Œé¢ï¼Œå°†jpgæ‹–è¿›010æŸ¥çœ‹16è¿›åˆ¶æ•°æ®æœ‰â€œExifâ€åˆ™æœ‰exifæ•°æ®**
>
> ****
>
> **æŸ¥çœ‹exif:**
>
> ****
>
> **~/misc# exiftool mm.png **
>
> **apt install exiftool**
>
> ****
>
> ExifTool Version Number         : 12.40
>
> File Name                       : mm.png
>
> Directory                       : .
>
> File Size                       : 405 KiB
>
> File Modification Date/Time     : 2025:00:0 20:03:16+08:00
>
> File Access Date/Time           : 2025:00:0 20:21:00+08:00
>
> File Inode Change Date/Time     : 2025:00:0 20:03:16+08:00
>
> File Permissions                : -rw-r--r--
>
> File Type                       : PNG
>
> File Type Extension             : png
>
> MIME Type                       : image/png
>
> Image Width                     : 861
>
> Image Height                    : 436
>
> Bit Depth                       : 8
>
> Color Type                      : RGB with Alpha
>
> flag : flag{ssssss}
>
> Compression                     : Deflate/Inflate
>
> Filter                          : Adaptive
>
> Interlace                       : Noninterlaced
>
> SRGB Rendering                  : Perceptual
>
> Gamma                           : 2.2
>
> Pixels Per Unit X               : 5669
>
> Pixels Per Unit Y               : 5669
>
> Pixel Units                     : meters
>
> Warning                         : [minor] Trailer data after PNG IEND chunk
>
> Image Size                      : 861x436
>
> Megapixels                      : 0.375
>

ä»¥ä¸Šæ˜¯miscçš„ä¸€äº›å¸¸è§ä¿¡æ¯æ”¶é›†ï¼Œå¯ä»¥å°†è¿™äº›å·¥å…·å’Œå‘½ä»¤é›†æˆåˆ°shellï¼Œä¸€é”®ä¿¡æ¯æ”¶é›†ï¼Œåç»­åšé¢˜æˆ‘ä»¬è¿˜å¯ä»¥æ ¹æ®æ–‡ä»¶çš„ä¸åŒæ·»åŠ å…¶ä»–çš„å·¥å…·å’Œå‘½ä»¤

```shell
#!/bin/bash
# ä½œä¸ºmiscçš„é€šç”¨tool

# é…è‰²
# åŸºæœ¬é¢œè‰²
BRIGHT_BLUE_TEXT="\033[1;34m"

# é‡ç½®é¢œè‰²
RESET="\033[0m"
# è“è‰²
BLUE_LB() {
    echo "${BRIGHT_BLUE_TEXT}${1}${RESET}\n"
}

# exifæ•°æ®æå–
BLUE_LB "------------ä¿¡æ¯æ”¶é›†---------------"

BLUE_LB "exiftool"
exiftool "$1"

# æ–‡ä»¶ç±»å‹è·å–
BLUE_LB "æ–‡ä»¶ç±»å‹"
file "$1"

# å…³é”®å­—

CHARKEY="flag|FLAG|pass|pk|PK|Pk|ctf|CTF|KEY|key|txt|PASS"

# å…³é”®å­—è·å–
BLUE_LB "å…³é”®å­—"
strings  "${1}" | grep "-E" "${CHARKEY}"
```

**è¾“å‡ºï¼š**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750131631266-6204e03c-48a8-4c97-845d-06d2758b8213.png)

ç»è¿‡è¿™äº›åŸºæœ¬ä¸Šé¢˜ç›®æ‰€ç»™æ–‡ä»¶çš„ç±»å‹ï¼Œexifæ•°æ®ï¼Œå…³é”®å­—ï¼Œæœ‰æ²¡æœ‰åµŒå…¥æ–‡ä»¶å°±éƒ½å¾ˆæ¸…æ¥šäº†ï¼Œåé¢è¿˜ä¼šåŠ å…¥éšå†™æ£€æµ‹ï¼Œå¦‚stegpy,zsteg,OurSecret,steghide,outguess,ä»¥åŠpngå®½é«˜æ£€æµ‹ç­‰ç­‰ï¼Œåœ¨miscåˆ†äº«çš„æœ€åä¼šå°†è¿™ä¸ªshellè„šæœ¬å®Œå–„ï¼Œå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿçš„æœé›†æ–‡ä»¶çš„ä¿¡æ¯å’Œè·å–éšå†™ä¿¡æ¯ï¼Œè§£é¢˜å¿«äººä¸€æ­¥ï¼Œè¿™ä¸ªå·¥å…·ä¹Ÿèƒ½é˜²é—å¿˜ï¼Œmiscçš„éšå†™å¤šç§å¤šæ ·ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆç¼–å†™shellè„šæœ¬çš„åŸå› 

### å›¾ç‰‡ç±»éšå†™
èµ„æ–™æ”¶é›†ï¼š

ä¸€ä¸ªéšå†™è§£æç½‘ç«™å¯ä»¥å…ˆæ”¾è¿›å»è·‘ä¸€ä¸‹

[https://aperisolve.fr/](https://aperisolve.fr/)

stegpyï¼š

> <font style="color:rgb(22, 18, 9);">å®‰è£…ï¼š</font>
>
> <font style="color:rgb(22, 18, 9);">pip3 install stegpy</font>
>

> ä½¿ç”¨ï¼šéœ€è¦å¯†ç 
>
> stegpy 1.png -p 
>

<font style="color:rgb(36, 41, 47);background-color:#FFFFFF;">Image Steganographyï¼š</font>

<font style="color:rgb(36, 41, 47);background-color:#FFFFFF;">ä½¿ç”¨Image Steganography decrypt</font>

npietç¼–ç¨‹è¯­è¨€ï¼š

[https://www.bertnase.de/npiet/npiet-execute.php](https://www.bertnase.de/npiet/npiet-execute.php)

<font style="color:rgb(85, 85, 85);">å°†ä¿¡æ¯éšå†™åœ¨å›¾ç‰‡</font>

[https://stylesuxx.github.io/steganography/](https://stylesuxx.github.io/steganography/)

[https://www.a.tools/Tool.php?Id=100](https://www.a.tools/Tool.php?Id=100)

å…‰æ …å›¾åƒï¼š

[https://github.com/AabyssZG/Raster-Terminator](https://github.com/AabyssZG/Raster-Terminator)

å·¥å…·ç«™ï¼š[https://tools.jb51.net/aideddesign/img_add_info](https://tools.jb51.net/aideddesign/img_add_info)

DeEgger Embedderéšå†™ <font style="color:rgb(22, 18, 9);">DeEgger Embedderå·¥å…·</font>

<font style="color:rgb(22, 18, 9);">æŠŠå°è¯´è—è¿›å›¾ç‰‡ å¯ä»¥å‚è€ƒ</font>[https://www.bilibili.com/video/BV1Ai4y1V7rg/?spm_id_from=333.999.0.0&vd_source=31399c09aa0c93655468bde7b13fcc03](https://www.bilibili.com/video/BV1Ai4y1V7rg/?spm_id_from=333.999.0.0&vd_source=31399c09aa0c93655468bde7b13fcc03)

ArnoldçŒ«è„¸å˜æ¢ï¼š

åŸç†ï¼š[https://www.jianshu.com/p/39727dbaffd9](https://www.jianshu.com/p/39727dbaffd9)

ä¸€ä¸ªç½‘ä¸Šçš„è„šæœ¬ï¼š

```python
from PIL import Image

def arnold(infile: str, outfile: str = None, a: int = 1, b: int = 1, shuffle_times: int = 1, reverse: bool = False) -> None:
    """
    ArnoldçŒ«è„¸å˜æ¢å‡½æ•°

    Parameters:
        infile - è¾“å…¥å›¾åƒè·¯å¾„
        outfile - è¾“å‡ºå›¾åƒè·¯å¾„
        a - Anrold å˜æ¢å‚æ•°
        b - Anrold å˜æ¢å‚æ•°
        shuffle_times - ç½®ä¹±æ¬¡æ•°
        reverse - é€†å˜æ¢
    """
    inimg = Image.open(infile)
    width, height = inimg.size
    indata = inimg.load()
    outimg = Image.new(inimg.mode, inimg.size)
    outdata = outimg.load()

    for _ in range(shuffle_times):
        for x in range(width):
            for y in range(height):
                if reverse:
                    nx = ((a * b + 1) * x - a * y) % width
                    ny = (y - b * x) % height
                else:
                    nx = (x + a * y) % width
                    ny = (b * x + (a * b + 1) * y) % height
                outdata[ny, nx] = indata[y, x]
    
    outimg.save(outfile if outfile else "arnold_"+infile, inimg.format)

arnold("before.png", "encode.png", 9, 39, 1)
arnold("encode.png", "decode.png", 9, 39, 1, True)

```

é€šå¸¸ç»™a bæ•°æ®å¯èƒ½ç»™n 

äºŒè¿›åˆ¶æ•°æ®/rgbæ•°æ®è½¬å›¾ç‰‡:

å›¾åƒé€†åºï¼š

```python
infile = 'int.png'
outfile = 'out.png'

with open(infile, "rb") as fin:
    with open(outfile, "wb") as fout:
        fout.write(fin.read()[::-1])

```

#### png
**å®½é«˜ï¼š**

**é¢˜ç›®ä¼šé€šè¿‡ä¿®æ”¹æ–‡ä»¶çš„å®½é«˜æ•°æ®ä½æ¥éšè—ä¸€äº›ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ¯”å¯¹crcä½å¾—åˆ°æ­£ç¡®çš„å®½é«˜å€¼**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750225698908-b103c10e-eb2e-4201-bddb-c2d936fc6fa4.png)

è¿™æ˜¯ä¸€ä¸ªä¿®æ”¹è¿‡å®½é«˜çš„å›¾ç‰‡çš„æˆªå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»…ä»…æœ‰ä¸€å¥è¯å…¶ä»–ä»€ä¹ˆä¹Ÿæ²¡æœ‰

è€Œå½“æˆ‘ä»¬æ­£ç¡®çš„ä¿®æ”¹å®½é«˜åå°±å¯ä»¥çœ‹åˆ°éšè—åœ¨å³ä¸‹è§’çš„flagå€¼

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750225802383-8794f857-21e4-40da-a9f3-96f54a4f7b33.png)

é€šå¸¸é‡åˆ°æ¯”ä¾‹å¥‡æ€ªçš„å›¾ç‰‡æˆ‘ä»¬éƒ½å¯ä»¥å°è¯•æ‰‹åŠ¨ä¿®æ”¹å®½é«˜

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750225899833-a5bdd2ac-e35a-4715-a381-dd0c74de1eaa.png)

1 å¤„å³ä¸º å®½åº¦æ•°æ® 2 å¤„ä¸ºé«˜åº¦æ•°æ® åœˆèµ·æ¥çš„åœ°æ–¹ä¸ºcrcæ•°æ®

å½“å°è¯•å‘ç°å¯èƒ½è¢«ä¿®æ”¹å®½é«˜åå¯ä»¥ä½¿ç”¨pythonè„šæœ¬æ£€æµ‹æ˜¯å¦ä¿®æ”¹äº†å®½é«˜å¹¶ä¿®å¤å¾—åˆ°æ­£ç¡®å®½é«˜çš„å›¾ç‰‡

```python
import binascii
import itertools
import os
import struct
import zlib
import click


@click.command()
@click.option("-f","--file", required=True,help="file path")

def png_hw(file):
    # ä¿®å¤png
    def modify_file_hex(file, position, new_hex_value):
                            try:
                                with open(file, 'rb') as f:
                                    content = f.read()
                                    hex_content = binascii.hexlify(content).decode()
                                    new_hex_content = hex_content[:position] + new_hex_value + hex_content[48:]
                                    modified_content = binascii.unhexlify(new_hex_content)
                                    output_file = os.path.join(os.path.dirname(file),
                                                                    'png_h_w_' + os.path.basename(file))
                                    with open(output_file, 'wb') as out_f:
                                        out_f.write(modified_content)
                                    return output_file
                            except FileNotFoundError:
                                return "æ–‡ä»¶ä¸å­˜åœ¨"
    try:
        png_data = open(f'{file}', 'rb').read()
        if png_data[:6].hex() != '89504e470d0a':
            print(f'épngæ–‡ä»¶')
        else:
            crc32key = zlib.crc32(png_data[12:29])  
            re_crc32 = int(png_data[29:33].hex(), 16) # åŸå§‹crc32å€¼
            width = struct.unpack('>i', png_data[16:20])[0]
            height = struct.unpack('>i', png_data[20:24])[0]
            print(f'æ–‡ä»¶å®½åº¦ï¼š{width}, æ–‡ä»¶é«˜åº¦ï¼š{height}')
            if crc32key == re_crc32:  
                print('æ–‡ä»¶å®½é«˜æ­£ç¡®')
            else:
                print('æ–‡ä»¶å®½é«˜ä¸æ­£ç¡®ï¼Œæ­£åœ¨çˆ†ç ´å®½é«˜')
                for i, j in itertools.product(range(4095),
                                                range(
                                                    4095)):  
                    data = png_data[12:16] + struct.pack('>i', i) + struct.pack('>i', j) + png_data[24:29]
                    crc32 = zlib.crc32(data)
                    if crc32 == re_crc32:  
                        position = 32  
                        def pad_to_eight(s):
                            while len(s) < 8:
                                s = '0' + s
                            return s
                        w_out = pad_to_eight(hex(i)[2:])
                        h_out = pad_to_eight(hex(j)[2:])
                        new_hex_value = w_out + h_out
                        output_path = modify_file_hex(file, position, new_hex_value)
                        if output_path:
                            print(f'æ–‡ä»¶è¾“å‡ºåœ¨{output_path}')
                        else:
                            print(f'æ–‡ä»¶é”™è¯¯')
    except ValueError:
        print("æ–‡ä»¶ error")
if __name__ == "__main__":
    png_hw()
```

**è¿è¡Œï¼š**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750226142647-a19ff46a-da10-497b-b656-08860b14c8d4.png)

**æ–‡ä»¶åˆ†ç¦»ï¼š**

**binwalk**

è¿™å·¥å…·kaliè‡ªå¸¦ï¼Œå¯ä»¥åœ¨è™šæ‹Ÿæœºå®‰è£…ä¸€ä¸ªkali

kali: [https://www.kali.org/get-kali/#kali-virtual-machines](https://www.kali.org/get-kali/#kali-virtual-machines)

vmè™šæ‹Ÿæœºï¼š[https://www.vmware.com/products/desktop-hypervisor/workstation-and-fusion](https://www.vmware.com/products/desktop-hypervisor/workstation-and-fusion)

vmä¸‹è½½éœ€è¦æ³¨å†Œï¼Œæ³¨å†Œå¥½æ— æ³•ç™»å½•å»è¿™é‡Œçš„mydownloads

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750226832605-2f428c4a-0442-42ae-8d20-98bda2d2eab9.png)

**ç”¨æ³•ï¼š**

```shell
binwalk -e filename
```

**foremost:**

> sudo apt install foremost -y  # å®‰è£…foremost
>

**ç”¨æ³•ï¼š**

```shell
foremost -i filename -o outpath
```

**ç›²æ°´å°ï¼š**

**å•å›¾ç›²æ°´å°ï¼šå¯ä»¥ä½¿ç”¨å¦‚ä¸‹è½¯ä»¶**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750227659203-a6b9f18a-7544-452e-9fd8-5d823664dd31.png)

[**https://www.123912.com/s/f2HzTd-9cz03**](https://www.123912.com/s/f2HzTd-9cz03)**æå–ç :FHgq**

**è¿˜æœ‰ä¸€ä¸ªjavaç›²æ°´å°å·¥å…· **[**https://github.com/ww23/BlindWatermark**](https://github.com/ww23/BlindWatermark)

**java -jar BlindWatermark-v0.0.3-windows-x86_64-gpu.jar decode -c gakki-dct-text-ec.jpg gakki-dct-text-dc.jpg**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750228630153-63c0463d-99e7-40a1-8677-19e0ba88161f.png)

**åŒå›¾ç›²æ°´å°ï¼š**

**å·¥å…·githubåœ°å€ï¼š**

[**https://github.com/chishaxie/BlindWaterMark#blindwatermark**](https://github.com/chishaxie/BlindWaterMark#blindwatermark)

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750228030031-36c0e674-96af-4199-844e-0bd2291f6c4d.png)

å¦ä¸€ä¸ªguiåŒ–çš„[https://github.com/fire-keeper/BlindWatermark](https://github.com/fire-keeper/BlindWatermark)

lsbéšå†™ï¼š

åœ¨pngå›¾ç‰‡ä¸­ï¼ŒåŒ…å«256çš„ä¸‰æ¬¡æ–¹ä¸ªé¢œè‰²ï¼Œå³16777216ç§ï¼Œäººç±»çš„çœ¼ç›å¯ä»¥åŒºåˆ†çº¦1,000ä¸‡ç§ä¸åŒçš„é¢œè‰²ï¼Œå‰©ä¸‹æ— æ³•åŒºåˆ†çš„é¢œè‰²å°±æœ‰6777216

LSBéšå†™å°±æ˜¯ä¿®æ”¹RGBé¢œè‰²åˆ†é‡çš„æœ€ä½äºŒè¿›åˆ¶ä½ä¹Ÿå°±æ˜¯æœ€ä½æœ‰æ•ˆä½ï¼ˆLSBï¼‰ï¼Œè€Œäººç±»çš„çœ¼ç›ä¸ä¼šæ³¨æ„åˆ°è¿™å‰åçš„å˜åŒ–ï¼Œæˆ‘ä»¬ä»…å¯¹RGBä¸­çš„æœ€ä½ä½è¿›è¡Œä¿®æ”¹ï¼Œå¦‚å½“å‰åƒç´ ä½ç‚¹æœ€åä¸€ä½ä¿®æ”¹æˆ1,1ï¼Œ0.åˆ™ä¸Šè¿°RGBå˜æˆ218->219ï¼š

ä¸Šè¿°å˜åŒ–å¾ˆéš¾ç”¨è‚‰çœ¼å¯Ÿè§‰åˆ°ï¼Œè€Œä¸”æ¯ä¸€ä¸ªåƒç´ ä½ç‚¹æºå¸¦äº†ä¸€ä½ä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…«ä¸ªå­—èŠ‚çš„æœ€ä½ä½å­˜å‚¨ä¸€ä¸ªæ¯”ç‰¹ä¿¡æ¯ï¼Œè€Œè¯¥æ¯”ç‰¹ä¿¡æ¯åˆ™å¯ä»¥è½¬åŒ–ä¸ºASCIIå­—ç¬¦ï¼Œä»è€Œè¾¾åˆ°éšå†™ä¿¡æ¯çš„ç›®çš„

**zsteg:**

> å®‰è£…ï¼š
>
> githubåœ°å€ [https://github.com/zed-0xff/zsteg](https://github.com/zed-0xff/zsteg)
>
> gem install zsteg
>

**ä¸»è¦ç”¨æ¥æ£€æµ‹pngçš„lsbéšå†™ï¼Œwbstego**

**StegSolve:**

**åŒæ ·å¯ä»¥æŸ¥çœ‹lsbï¼Œå¯ä»¥æŸ¥çœ‹jpg...**

**åœ¨é‡åˆ°é¢˜ç›®ç»™ä¸¤å¼ å›¾ç‰‡çš„æ—¶å€™äº¦å¯ä»¥ä½¿ç”¨ä»–è¿›è¡ŒåŒå›¾xorç­‰**

**IDAT å—:**

**æŸ¥çœ‹idatå—æ˜¯å¦æ­£ç¡®ï¼Œæ˜¯å¦æœ‰å¤šä½™çš„ï¼Œå¯èƒ½ä¸ºåˆ«çš„å›¾åƒçš„æ•°æ®å—**

```shell
pngcheck file
```

#### jpg
**<font style="color:rgb(22, 18, 9);">OurSecretéšå†™ï¼š</font>**

**<font style="color:rgb(22, 18, 9);">ç‰¹å¾æ˜æ˜¾ï¼Œæœ‰å¦‚ä¸‹æ•°æ®</font>**

```shell
9E 97 BA 2A 00 80 88 C9 A3 70 97 5B A2 E4 99 B8
C1 78 72 0F 88 DD DC 34 2B 4E 7D 31 7F B5 E8 70
39 A8 B8 42 75 68 71 91

```

æœ‰å¯†ç ï¼Œå¯ä»¥æ— å¯†ç 

**stegdetect:**

stegdetect.exe -t jopi -s 10.0 1.jpg

æ£€æµ‹åŠ å¯†

**silenteyeï¼š**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750231191904-f3d178e3-76b7-4707-acff-2a99905bf82a.png)

**steghideï¼š**

```bash
steghide extract -sf filename -p passwd
```

**<font style="color:rgb(44, 63, 81);">JPHSï¼š</font>**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750231214798-d09b16fc-f243-48c2-aa00-529fd548a942.png)

**<font style="color:rgb(85, 85, 85);">outguessï¼š</font>**

```bash
outguess -k "pass" -r 1.jpg flag.txt
#-k å¯†é’¥
#flag.txt ä¿å­˜ä½ç½®
```

**<font style="color:rgb(85, 85, 85);">pixeljihadï¼š</font>**

**<font style="color:rgb(85, 85, 85);">åœ¨çº¿ï¼š</font>**[**https://sekao.net/pixeljihad/**](https://sekao.net/pixeljihad/)

**F5-steganography:**

```bash
#æœ‰å¯†ç 
java Extract 1.jpg -p passwd
#æ— å¯†ç 
java Extract 1.jpg
#æ•°æ®ä¼šæ”¾åˆ°F5æ–‡ä»¶å¤¹çš„output.txt

```

**JPGå®½é«˜éšå†™:**

**å› ä¸ºjpgå’Œpngä¸åŒï¼Œæ— æ³•çˆ†ç ´crcç¡®å®šæ­£ç¡®çš„å®½é«˜åªèƒ½æ‰‹åŠ¨ä¿®æ”¹**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750231409809-e60de58c-012e-46e8-becf-a4fd75b872ba.png)

#### bmp
**å®½é«˜ï¼š**

å¯ä»¥ä½¿ç”¨gimpä¿®æ”¹

bmpæ–‡ä»¶å¤´å»æ‰

**<font style="color:rgb(36, 41, 47);background-color:#FFFFFF;">silenteyeï¼šåŒä¸Šé¢çš„jpg</font>**

**<font style="color:rgb(36, 41, 47);background-color:#FFFFFF;">wbStego4open: åŒä¸Š</font>**

#### gif
**gifåˆ†ç¦»ï¼š**

```shell
convert flag.gif flag.png
```

**å¸§é—´éš”ï¼š**

```bash
identify -format "%s %T \n" flag.gif 
```

#### ......

### éŸ³è§†é¢‘éšå†™
[https://www.123912.com/s/f2HzTd-ZhL03](https://www.123912.com/s/f2HzTd-ZhL03)æå–ç :LCtD

#### wav
**<font style="color:rgb(36, 41, 47);">silenteye:</font>**

<font style="color:rgb(36, 41, 47);">å¯èƒ½æ˜¯silenteyeéšå†™,ä½¿ç”¨å¦‚åŒjpgï¼Œæœ‰å¯†åŒ™ä½¿ç”¨å¯†åŒ™è§£</font>

**<font style="color:rgb(36, 41, 47);">deepsoundï¼š</font>**

ä½¿ç”¨deepsound æ‰“å¼€ï¼Œå¦‚æœéœ€è¦å¯†ç è¯´æ˜å°±æ˜¯ deepsound éšå†™ï¼Œæœ‰å¯†é’¥ç›´æ¥å¡«å…¥å¯†é’¥è§£å¯†å³å¯

å¦‚æœæ˜¯ deepsound éšå†™ä½†æ²¡æœ‰å¯†é’¥ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯æœ‰ä½¿ç”¨deepsound2johnè„šæœ¬è·å–wavæ–‡ä»¶çš„å“ˆå¸Œå€¼

ç„¶åç”¨johnçˆ†ç ´hash

ç”¨æ³•: john 1.txt

> https://github.com/openwall/john/blob/bleeding-jumbo/run/deepsound2john.py
>

**sstvï¼š**

å·¥å…·ï¼š[https://github.com/colaclanth/sstv](https://github.com/colaclanth/sstv)

å¯ä»¥ä½¿ç”¨rx-sstv

ä¹Ÿå¯ä»¥ä½¿ç”¨é›†æˆçš„å·¥å…·

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752725113336-51e85718-bce8-45c3-8c4e-38b9775ca8e3.png)

**<font style="color:rgb(22, 18, 9);">ç”µè¯éŸ³åˆ†æ(DTMF)ï¼š</font>**

<font style="color:rgb(22, 18, 9);">ä½¿ç”¨å·¥å…·ï¼šdtmf2num.exe</font>

<font style="color:rgb(22, 18, 9);">ç”¨æ³•ï¼šdtmf2num.exe xxx.wav</font>

**<font style="color:rgb(22, 18, 9);">Audacityï¼š</font>**

<font style="color:rgb(22, 18, 9);">ä½¿ç”¨Audacity.exeæ‰“å¼€æŸ¥çœ‹æ˜¯å¦æœ‰å­—ç¬¦ä¸²ç­‰ä¿¡æ¯</font>

**<font style="color:rgb(22, 18, 9);">steghideï¼š</font>**

<font style="color:rgb(22, 18, 9);">ä¹Ÿå¯èƒ½æ˜¯steghide</font>

<font style="color:rgb(22, 18, 9);">ç”¨æ³•ï¼š</font>

```bash
steghide extract -sf filename -p passwd
```

#### mp3
**<font style="color:rgb(22, 18, 9);">mp3stegoï¼š</font>**

<font style="color:rgb(22, 18, 9);">å·¥å…·åœ°å€ï¼š</font>[https://www.petitcolas.net/steganography/mp3stego/](https://www.petitcolas.net/steganography/mp3stego/)

ç”¨æ³•ï¼š

> decode -X -P pass sound.mp3     
> -X æ˜¯æå–å‡ºéšå†™çš„æ–‡ä»¶  
> passæ˜¯è§£å¯†æ—¶éœ€è¦çš„å¯†ç    
> sound.mp3æ˜¯å¾…å¤„ç†çš„MP3æ–‡ä»¶  
> # mp3stegoå¯ä»¥ä½¿ç”¨æ— å¯†ç è¿›è¡Œéšå†™
>

**stegpyï¼š**

```bash
stegpy 1.wav -p
```

**<font style="color:rgb(22, 18, 9);">DeEgger Embedderï¼š</font>**

<font style="color:rgb(22, 18, 9);">åœ°å€ï¼š</font>[https://www.softpedia.com/get/Security/Encrypting/DeEgger-Embedder.shtml](https://www.softpedia.com/get/Security/Encrypting/DeEgger-Embedder.shtml)

### æ–‡æ¡£ç±»éšå†™

#### pdf
**åµŒå…¥æ–‡ä»¶ï¼š**

ä½¿ç”¨binwalk æˆ–è€… foremost

**<font style="color:rgb(36, 41, 47);">wbStego4open:</font>**

<font style="color:rgb(22, 18, 9);">ä½¿ç”¨</font><font style="color:rgb(36, 41, 47);">wbStego4open</font><font style="color:rgb(22, 18, 9);">å¸¦å¯†é’¥</font>

**<font style="color:rgb(22, 18, 9);">æœ‰å¯†ç ï¼š</font>**

<font style="color:rgb(22, 18, 9);">ä½¿ç”¨pdfcrackçˆ†ç ´å¯†ç ï¼ˆUbuntu: apt install pdfcrackï¼‰</font>

```bash
pdfcrack -f enc.pdf -w rockyou.txt
```

#### word
å¯èƒ½å°†æ–‡å­—éšè—ï¼Œå…¨é€‰ä¿®æ”¹èƒŒæ™¯å’Œå­—ä½“é¢œè‰²å³å¯çœ‹åˆ°éšè—çš„

ä½¿ç”¨binwalkåˆ†ç¦»é™„åŠ çš„æ–‡ä»¶

åˆ©ç”¨è¡Œè·éšå†™å°†è¡Œè·çš„ä¸ç”¨è½¬åŒ–ä¸º01è§£æ‘©æ–¯å¯†ç ï¼ˆå¦‚ï¼š<font style="color:rgb(22, 18, 9);">ISCC2023-æ±¤å§†å†é™©è®° </font>ï¼‰

#### ppt
æœ€å¸¸è§çš„binwalkåˆ†ç¦»

#### excel
<font style="color:rgb(22, 18, 9);">ä½¿ç”¨è®°äº‹æœ¬æ‰“å¼€æŸ¥æ‰¾flag</font>

<font style="color:rgb(22, 18, 9);">æŸ¥çœ‹å•å…ƒæ ¼çš„ä¸åŒï¼Œå°†ä¸åŒçš„æ ¼åˆ†åˆ«è½¬åŒ–ä¸ºé»‘ç™½æ ¼ç»„æˆäºŒç»´ç </font>

<font style="color:rgb(22, 18, 9);">binwalk</font>

#### ......

### æ–‡æœ¬ç±»éšå†™

#### é›¶å®½
é›¶å®½éšå†™æ˜¯ä¸€ç§åˆ©ç”¨é›¶å®½åº¦å­—ç¬¦åœ¨æ–‡æœ¬ä¸­éšè—ä¿¡æ¯çš„æŠ€æœ¯ï¼Œè¿™äº›å­—ç¬¦åœ¨è§†è§‰ä¸Šä¸å¯è§ï¼Œä½†å¯ä»¥å­˜å‚¨å’Œä¼ é€’éšç§˜ä¿¡æ¯ã€‚

å¯ä»¥ä½¿ç”¨åœ¨çº¿ç½‘ç«™ï¼š

[https://tool.bfw.wiki/tool/1695021695027599.html](https://tool.bfw.wiki/tool/1695021695027599.html)

[https://www.hanloth.cn/tool/zero-width-secret](https://www.hanloth.cn/tool/zero-width-secret)

æˆ–è€…é›†æˆå·¥å…·ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752726462853-d166bc78-1150-4ae1-a05a-55c02deb39e8.png)

#### baseéšå†™
**å¯ä»¥ä½¿ç”¨é›†æˆå·¥å…·ï¼š**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752726579560-89fc51c7-029d-43cd-acce-214b48528f67.png)

#### ......
**<font style="color:rgb(22, 18, 9);">snowéšå†™ï¼š</font>**

<font style="color:rgb(22, 18, 9);">SNOW.EXE -C -p password flag.txt </font>

**<font style="color:rgb(22, 18, 9);">åƒåœ¾é‚®ä»¶éšå†™(spammimic)ï¼š</font>**

<font style="color:rgb(22, 18, 9);">ä½¿ç”¨åœ¨çº¿ç½‘ç«™è§£å¯†ï¼š</font>

[<font style="color:rgb(35, 118, 183);">https://www.spammimic.com/</font>](https://www.spammimic.com/)

**æ–‡å­—éšå†™ï¼š**

åœ¨çº¿ç½‘ç«™ï¼š

[https://toolshu.com/hide-text](https://toolshu.com/hide-text)

### ......

## æµé‡åˆ†æ
ä½¿ç”¨Wireshark.exeæ‰“å¼€ç›´æ¥æœç´¢

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752726760518-dc6ab77c-2709-4d3e-a171-cb3f24b4cee0.png)

æˆ–è€…å¯¼å‡ºæ–‡ä»¶

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752726835375-1cb334d9-8019-40c9-886e-6faa7cb4fe46.png)

## å–è¯é¢˜åˆ†æ
ä½¿ç”¨volè§£æ

## å‹ç¼©åŒ…é¢˜åˆ†æ

### ä¼ªåŠ å¯†

```python
ZIPä¼ªåŠ å¯†æ˜¯ä¸€ç§é€šè¿‡ä¿®æ”¹ZIPæ–‡ä»¶å¤´éƒ¨çš„åŠ å¯†æ ‡å¿—ä½ï¼Œä½¿æ–‡ä»¶è¢«è¯†åˆ«ä¸ºåŠ å¯†å‹ç¼©åŒ…çš„æŠ€æœ¯ã€‚å®é™…ä¸Šï¼Œè¿™ç§åŠ å¯†å¹¶ä¸çœŸæ­£ä¿æŠ¤æ–‡ä»¶å†…å®¹ï¼Œå› æ­¤è¢«ç§°ä¸ºâ€œä¼ªåŠ å¯†â€ã€‚ä»¥ä¸‹æ˜¯ZIPä¼ªåŠ å¯†çš„åŸç†åŠå…¶å¤„ç†æ–¹æ³•ã€‚

ZIPæ–‡ä»¶ç»“æ„ä¸ä¼ªåŠ å¯†åŸç†

ä¸€ä¸ªZIPæ–‡ä»¶é€šå¸¸ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š

å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼šåŒ…å«æ–‡ä»¶çš„å®é™…æ•°æ®ã€‚

å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼šè®°å½•æ–‡ä»¶çš„å…ƒä¿¡æ¯ã€‚

å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼šæ ‡è®°ç›®å½•çš„ç»“æŸã€‚

åœ¨ZIPæ–‡ä»¶ä¸­ï¼ŒåŠ å¯†å±æ€§ç”±â€œå…¨å±€æ–¹å¼ä½æ ‡è®°â€å†³å®šï¼š

æ— åŠ å¯†ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º00 00ã€‚

ä¼ªåŠ å¯†ï¼šæ•°æ®åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º00 00ï¼Œä½†ç›®å½•åŒºçš„æ ‡è®°è¢«ä¿®æ”¹ä¸º09 00ã€‚

çœŸåŠ å¯†ï¼šæ•°æ®åŒºå’Œç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°å‡ä¸º09 00ã€‚

ä¼ªåŠ å¯†çš„æ ¸å¿ƒåœ¨äºä¿®æ”¹ç›®å½•åŒºçš„æ ‡è®°ï¼Œä½¿å…¶æ˜¾ç¤ºä¸ºåŠ å¯†çŠ¶æ€ï¼Œä½†å®é™…æ•°æ®å¹¶æœªåŠ å¯†ã€‚
```

ç›´æ¥ä½¿ç”¨é›†æˆå·¥å…·

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752727513475-9c47a687-f1b9-45fc-bd50-161b3b61c249.png)

### çˆ†ç ´
**archpr:**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752727604255-934f859f-f00d-4df1-95d5-bbc13f0cf198.png)

### æ˜æ–‡çˆ†ç ´
ä¹Ÿå¯ä½¿ç”¨ä¸Šè¿°å·¥å…·

è¦æ±‚ï¼š

<font style="color:rgb(51, 51, 51);">è‡³å°‘å·²çŸ¥æ˜æ–‡çš„12ä¸ªå­—èŠ‚åŠåç§»ï¼Œå…¶ä¸­è‡³å°‘8å­—èŠ‚éœ€è¦è¿ç»­ã€‚</font>

<font style="color:rgb(51, 51, 51);">æ˜æ–‡å¯¹åº”çš„æ–‡ä»¶åŠ å¯†æ–¹å¼ä¸ºZipCrypto Store</font>

**<font style="color:rgb(51, 51, 51);">bkcrack:</font>**

[https://github.com/kimci86/bkcrack](https://github.com/kimci86/bkcrack)

### crcçˆ†ç ´
<font style="color:rgb(22, 18, 9);">å‹ç¼©åŒ…ä¸­æ–‡ä»¶æ¯”è¾ƒå°åªæœ‰å‡ å­—èŠ‚</font>

<font style="color:rgb(22, 18, 9);">å·¥å…·ï¼š</font>

[https://github.com/AabyssZG/CRC32-Tools](https://github.com/AabyssZG/CRC32-Tools)

[https://github.com/theonlypwner/crc32](https://github.com/theonlypwner/crc32)

### ......

# CRYPTO

## RSA

### RSAåŸºç¡€ç†è®ºåŠåŠ è§£å¯†è¿‡ç¨‹
å·¥å…·é›†æˆäº†ä¸€äº›å¸¸è§çš„rsaæ”»å‡»æ–¹å¼ åªéœ€è¦äº†è§£ç›¸å…³æ”»å‡»å³å¯ä½¿ç”¨

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1753933177946-d2a90513-cc04-4aa2-be1f-53606026646e.png)

<font style="color:rgb(32, 33, 34);">å¯¹æå¤§æ•´æ•°åš</font>[<font style="color:rgb(51, 102, 204);">å› æ•°åˆ†è§£</font>](https://zh.wikipedia.org/wiki/%E5%9B%A0%E6%95%B0%E5%88%86%E8%A7%A3)<font style="color:rgb(32, 33, 34);">çš„éš¾åº¦å†³å®šäº† RSA ç®—æ³•çš„å¯é æ€§ã€‚æ¢è¨€ä¹‹ï¼Œå¯¹ä¸€æå¤§æ•´æ•°åšå› æ•°åˆ†è§£æ„ˆå›°éš¾ï¼ŒRSA ç®—æ³•æ„ˆå¯é ã€‚å‡å¦‚æœ‰äººæ‰¾åˆ°ä¸€ç§å¿«é€Ÿå› æ•°åˆ†è§£çš„ç®—æ³•çš„è¯ï¼Œé‚£ä¹ˆç”¨ RSA åŠ å¯†çš„ä¿¡æ¯çš„å¯é æ€§å°±ä¼šæåº¦ä¸‹é™ã€‚ä½†æ‰¾åˆ°è¿™æ ·çš„ç®—æ³•çš„å¯èƒ½æ€§æ˜¯éå¸¸å°çš„ã€‚ä»Šå¤©åªæœ‰çŸ­çš„ RSA é’¥åŒ™æ‰å¯èƒ½è¢«å¼ºåŠ›æ–¹å¼ç ´è§£ã€‚åˆ°2020å¹´ä¸ºæ­¢ï¼Œä¸–ç•Œä¸Šè¿˜æ²¡æœ‰ä»»ä½•å¯é çš„æ”»å‡»RSAç®—æ³•çš„æ–¹å¼ã€‚åªè¦å…¶é’¥åŒ™çš„é•¿åº¦è¶³å¤Ÿé•¿ï¼Œç”¨RSAåŠ å¯†çš„ä¿¡æ¯å®é™…ä¸Šæ˜¯ä¸èƒ½è¢«ç ´è§£çš„ã€‚</font>

ç»´åŸºç™¾ç§‘ï¼š

[https://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95](https://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95)

pythonçš„ç®€å•å®ç°ï¼š

```python
from Crypto.Util.number import getPrime, inverse, bytes_to_long, long_to_bytes

flag =  b'flag{RSA}'

# ç”Ÿæˆ1024ä½çš„ç´ æ•°på’Œq

p = getPrime(1024)
q = getPrime(1024)

# è®¡ç®—n, e, phi, då’Œc
n = p * q

e = 65537

phi = (p - 1) * (q - 1)

assert GCD(e, phi) == 1, "è¯¥eä¸æ»¡è¶³äº’ç´ æ¡ä»¶"

d = inverse(e, phi)

c = pow(bytes_to_long(flag), e, n)

m = pow(c, d, n)

print(f'n = {n}')
print(f'e = {e}')   
print(f'd = {d}')
print(f'c = {c}')
print(f'm = {long_to_bytes(m)}')
```

rsaé¢˜ç›®å¸¸è§çš„å‚æ•° 

p ç´ æ•°ç”Ÿæˆn

q ç´ æ•°ç”Ÿæˆn

pq æ˜¯è§£é¢˜çš„å…³é”® é€šå¸¸è¦æ±‚çš„å‚æ•°

n ä¸eç»„æˆå…¬é’¥

e ä¸nç»„æˆå…¬é’¥

c åŠ å¯†åçš„å¯†æ–‡

phi nçš„æ¬§æ‹‰ =(p-1)*(q-1) pq = n p+q pq -p -q +1 = pq - (p+q) + 1 

d  ç§é’¥ è§£é¢˜çš„å…³é”®

m æ˜æ–‡

é€šå¸¸é¢˜ç›®ä¼šç»™ n e c 

æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸‰ä¸ªå‚æ•°æ¥åˆ¤æ–­ä½¿ç”¨é‚£äº›æ”»å‡»æ–¹å¼

ä¸€å¼€å§‹æˆ‘ä»¬å¯ä»¥å°è¯•åˆ†è§£Nï¼Œå¦‚æœnä¸å¤§

[http://www.factordb.com/](http://www.factordb.com/)

è¿™æ˜¯ä¸€ä¸ªè®°å½•äº†å¾ˆå¤šå·²ç»è¢«åˆ†è§£çš„nçš„pq

æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨yafuåˆ†è§£ï¼Œå¦‚æœpqç›¸å·®è¾ƒå¤§æˆ–å°çš„æ—¶å€™ï¼Œå¯ä»¥æ ¹æ®é¢˜ç›®æ‰€ç»™åŠ å¯†ä»£ç åˆ¤æ–­

[https://sourceforge.net/projects/yafu/](https://sourceforge.net/projects/yafu/)

æˆ‘ä»¬è¿˜éœ€è¦å­¦ä¹ ä¸€äº›pythonåº“

Crypto

gmpy2

### å¸¸è§æ”»å‡»æ–¹å¼

#### <font style="color:rgb(0, 0, 0);">å°æ˜æ–‡æ”»å‡»</font>
å½“é¢˜ç›®ä¸­Nç‰¹åˆ«å¤§çš„æ—¶å€™å¯ä»¥å°è¯•

æˆ‘ä»¬å·²çŸ¥ â… :  C  <font style="color:rgb(0, 0, 0);">â‰¡</font>![image](https://cdn.nlark.com/yuque/__latex/cc221ed71b2d6a5f6487c0d93be71c3d.svg)<font style="color:rgb(0, 0, 0);">(mod N)</font>

<font style="color:rgb(0, 0, 0);">å½“må¾ˆå°çš„æ—¶å€™ mçš„eæ¬¡æ–¹å°äºn</font>

<font style="color:rgb(0, 0, 0);">æ‰€ä»¥ c å°±ç­‰äº mçš„eæ¬¡æ–¹ æ­¤æ—¶æˆ‘ä»¬åªè¦å°† c å¼€ e æ¬¡æ–¹å°±å¯ä»¥å¾—åˆ° m</font>

<font style="color:rgb(0, 0, 0);">è¿™é‡Œä½¿ç”¨ gmpy2 åº“çš„irootå¼€æ–¹</font>

```python
from Crypto.Util.number import *
from gmpy2 import *
n  = 536410484994483033093334003836655729325470269375524009439921349251765426879326472420715343135213685847853149465047363004844978980705334818310367627899054282724091430760574321302693735313741776534635308880108579425210969875273787315835179223662471838419622222586196334875552681127482220681804218077447446727632367288719418398225173584249649494060944903031644643599350735559974998992685357629587918116319437983541031003274274249512385723959144711034887286740398048911255492577006594659820438597055144909808217806214389981467817007584648955570726162669186034727073111376869516381199706615431972535815322666741187757365776611420640881256943303112723909875163327558585208160248953717008905206187852681531673607531360656420914879152163720617911529983435735678874123738624814506966909449518581239944997840945458848686624613184987748822188025864390108649415309566456540845277892075600527410134107469406816659137099034223840641145291291677316961839250222786771084598108203101897949775024306470936804403534408830935782941709356062377127100322538567707179546810871854386057481906331948667458888491116697493079241029509563403449393692443545157249665866189068291745976311888965264882340009888119575540460672793226773934767675512684750592502994661
e = 47
c = 229899396883582392364871905906445296949203163435377967308523386636507105732351552139686055293875453912112843930875659740397422297275613832964886182478284228932337946906215427434632071627272673570051303664678550765869183098488754645162034875760803916176659931431903280877040008151839312486086810338837714295821068677830038145047288362507454852643283361570635475479731085221630599511037989875119938896391192076787426053096532792131784563523065082875308622036981017576697767085294161885999051064464805324234829382111945083257918268260979566515252826957333562648074716098524243209378279602403795364197351006272703919005850152191380237640254523031072133802051271379417062521178212883200712566363108988562038188056490055724405896019781505695009412712690784013380990981185039802898643638127923786296260202685639474550000877637714438089700174399902960859666510114240835250541384360368049671274643421485904308653603924744567918821295775350084960806905039253932125210810019431964659889918601526879604439206186643987785399968027152305034576184766368079201408412844596024313611950909884330051927770353597750655703028328638756559133666564620074677469304330050449745861462898383722361080035329755112868572844306365995005218909407333254086037  

m = iroot(c, e)

print(long_to_bytes(m[0]))
```

#### <font style="color:rgb(0, 0, 0);">ä½åŠ å¯†æŒ‡æ•°æ”»å‡»</font>
ç”± â…  æ¶ˆå»æ¨¡ å¾—åˆ° ![image](https://cdn.nlark.com/yuque/__latex/5408886ac0518174dec52ede9a1a5951.svg)= c + k*n

å½“eå¾ˆå°çš„æ—¶å€™ æˆ‘ä»¬å¯ä»¥çˆ†ç ´k å¾—åˆ°æ­£ç¡®çš„ ![image](https://cdn.nlark.com/yuque/__latex/5408886ac0518174dec52ede9a1a5951.svg)

```python
from Crypto.Util.number import *
from gmpy2 import *
n = 25066689877776679233022203369122860358311144108034322786249336304184718167290635002070039262490792542129164733263246201499413220464411226682235152645481523633440451076347588502189820875766207732385081347542902014379448935897761402426197951109899225264278881605284920398145164965059125758041113782043
e = 5
c = 9580937997026657207695606535792321409809664111257153374644767194117132680120146044970386750643915697649050660680091489013318267184823888266207920970701381149337870449324937658700572686851552653818796958133992739190614740958850104564209920508542730206551286453342339610980738869413911612550009452577
for k in range(100000):
    me = c + k*n
    res = iroot(me, e) # irootè¿”å› ä¸€ä¸ªå…ƒç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ•´æ•°çš„æ•´æ•°æ ¹ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ˜¯æ•´æ•°æ ¹
    if res[1]:
        m = res[0]
        break
print(long_to_bytes(m))
```

#### <font style="color:rgb(0, 0, 0);">Rabinç®—æ³•æ”»å‡»</font>
ä¸€ä¸ªæ˜¾è‘—çš„ç‰¹å¾ eä¸º2

```python
from Crypto.Util.number import *
from gmpy2 import *

p = 
q = 
e = 2
c = 

def rabin_attack(c, n, p, q):
    c1 = powmod(c, (p+1)//4, p)
    c2 = powmod(c, (q+1)//4, q)
    cp1 = p - c1
    cp2 = q - c2

    t1 = invert(p, q)
    t2 = invert(q, p)

    m1 = (q*c1*c2 + p*c2*t1) % n
    m2 = (q*c1*t2 + p*cp2*t1) % n
    m3 = (q*cp1*t2 + p*c2*t1) % n
    m4 = (q*cp1*t2 + p*cp2*t1) % n

    return m1, m2, m3, m4

ms = rabin_attack(c, p*q, p, q)

for m in ms:
    print(long_to_bytes(m))
```

#### <font style="color:rgb(0, 0, 0);">Wieneræ”»å‡»</font>
[https://github.com/pablocelayes/rsa-wiener-attack](https://github.com/pablocelayes/rsa-wiener-attack)

```python
from Crypto.Util.number import *
from gmpy2 import *

n = 
e = 
c = 

class ContinuedFraction():
    def __init__(self, numerator, denumerator):
        self.numberlist = []  
        self.fractionlist = []  
        self.GenerateNumberList(numerator, denumerator)
        self.GenerateFractionList()

    def GenerateNumberList(self, numerator, denumerator):
        while numerator != 1:
            quotient = numerator // denumerator
            remainder = numerator % denumerator
            self.numberlist.append(quotient)
            numerator = denumerator
            denumerator = remainder

    def GenerateFractionList(self):
        self.fractionlist.append([self.numberlist[0], 1])
        for i in range(1, len(self.numberlist)):
            numerator = self.numberlist[i]
            denumerator = 1
            for j in range(i):
                temp = numerator
                numerator = denumerator + numerator * self.numberlist[i - j - 1]
                denumerator = temp
            self.fractionlist.append([numerator, denumerator])


a = ContinuedFraction(e, n)
for k, d in a.fractionlist:
    m = powmod(c, d, n)
    flag = long_to_bytes(m)
    
    if b'flag' in flag:  #æ ¹æ®å…·ä½“çš„flagå¤´æ›´æ”¹
        print(flag)
```

#### <font style="color:rgb(0, 0, 0);">ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»</font>
<font style="color:rgb(51, 51, 51);">å½“æœ‰å¤šç»„nï¼Œcçš„æ—¶å€™ï¼Œä¸”eå°</font>

```python
import libnum
from gmpy2 import invert, gcd, iroot

def op(x):
    res = 1
    for i in x:
        res *= i
    return res

def CRT(m, a):
    assert (len(m) == len(a))
    M = op(m)
    sum = 0
    for m, a in zip(m, a):
        Mi = M // m
        ti = invert(Mi, m)
        sum += a * ti * Mi
    return sum % M
def GCRT(m, a):
    assert (len(m) == len(a))
    curm, cura = m[0], a[0]
    for m, a in zip(m[1:], a[1:]):
        d = gcd(curm, m)
        c = a - cura
        assert (c % d == 0)
        K = c // d * invert(curm // d, m // d)
        cura += curm * K
        curm = curm * m // d
    return cura % curm

e= 23
n= [, , , , , , ]
c= [, , , , , , ]

m = CRT(n, c)
m1 = iroot(m, e)  # å¼€eæ¬¡æ–¹
print(m1)
print(libnum.n2s(int(m1[0])))
```

#### <font style="color:rgb(0, 0, 0);">p-1å…‰æ»‘æ”»å‡»</font>
<font style="color:rgb(51, 51, 51);">å…‰æ»‘æ•°ï¼šæŒ‡å¯ä»¥åˆ†è§£ä¸ºå°ç´ æ•°ä¹˜ç§¯çš„æ­£æ•´æ•°</font>

```python
from Crypto.Util.number import *
from gmpy2 import *
n =
e = 65537
c = 
a = 2
m = 2
while True:
    a = powmod(a, m, n)
    p = gcd(a-1, n)
    if p != 1 and p != n:
        break
    m += 1
print(p)
q = n // p

phi = (p-1)*(q-1)
d = invert(e, phi)
m = powmod(c, d, n)
print(long_to_bytes(m))
```

#### <font style="color:rgb(0, 0, 0);">p+1å…‰æ»‘æ”»å‡»</font>

```python
from Crypto.Util.number import *
from gmpy2 import *
from itertools import count

n = 
e = 65537
c = 

def mlucas(v, a, n):
    v1, v2 = v, (v ** 2 - 2) % n
    for bit in bin(a)[3:]: v1, v2 = ((v1 ** 2 - 2) % n, (v1 * v2 - v) % n) if bit == "0" else (
        (v1 * v2 - v) % n, (v2 ** 2 - 2) % n)
    return v1

def primegen():
    yield 2
    yield 3
    yield 5
    yield 7
    yield 11
    yield 13
    ps = primegen()  # yay recursion
    p = ps.__next__() and ps.__next__()
    q, sieve, n = p ** 2, {}, 13
    while True:
        if n not in sieve:
            if n < q:
                yield n
            else:
                next, step = q + 2 * p, 2 * p
                while next in sieve:
                    next += step
                sieve[next] = step
                p = ps.__next__()
                q = p ** 2
        else:
            step = sieve.pop(n)
            next = n + step
            while next in sieve:
                next += step
            sieve[next] = step
        n += 2

def ilog(x, b):  # greatest integer l such that b**l <= x.
    l = 0
    while x >= b:
        x /= b
        l += 1
    return l

def attack(n):
    for v in count(1):
        for p in primegen():
            e = ilog(isqrt(n), p)
            if e == 0:
                break
            for _ in range(e):
                v = mlucas(v, p, n)
            g = gcd(v - 2, n)
            if 1 < g < n:
                return int(g), int(n // g)  # g|n
            if g == n:
                break

p, q = attack(n)


phi = (p-1)*(q-1)
d = invert(e, phi)
m = powmod(c, d, n)
print(long_to_bytes(m))
```

#### <font style="color:rgb(0, 0, 0);">å…±æ¨¡æ”»å‡»</font>
é¢˜ç›®ç»™å‡ºä¸¤å¯¹e c å…¬ç”¨åŒä¸€ä¸ªn

```python
from gmpy2 import *
from Crypto.Util.number import *

n = 

e1 = 
e2 = 

c1 = 
c2 = 

_, s1, s2 = gcdext(e1, e2)

m = powmod(c1, s1, n) * powmod(c2, s2, n) % n
print(long_to_bytes(m))
```

#### <font style="color:rgb(0, 0, 0);">dp&dqæ³„éœ²æ”»å‡»</font>

```python
import gmpy2
import libnum
def decrypt(dp,dq,p,q,c):
    InvQ = gmpy2.invert(q, p)
    mp = pow(c, dp, p)
    mq = pow(c, dq, q)
    m = (((mp-mq)*InvQ) % p)*q+mq
    print(libnum.n2s(int(m)).decode())
p= 
q= 
dq= 
dp= 
c= 
decrypt(dp,dq,p,q,c) 
```

#### <font style="color:rgb(0, 0, 0);">dpæ³„éœ²æ”»å‡»</font>

```python
import libnum
import gmpy2
n= 
e= 65537
dp= 
c= 
for i in range(1,65535):
    p=(dp*e-1)//i+1
    if n%p==0:
        q=n//p
        break
phi_n= (p-1)*(q-1)
d=gmpy2.invert(e,phi_n)
m=pow(c,d,n)
print(m)
flag=libnum.n2s(int(m)).decode()
print(flag)
```

#### <font style="color:rgb(0, 0, 0);">eå¾ˆå¤§çš„dpæ³„éœ²æ”»å‡»</font>

```python
from Crypto.Util.number import *
from gmpy2 import *

n = 
e = 
c = 
dp = 

m = #éšæœº
p = gcd(powmod(m, e*dp, n) - m, n)
q = n // p
d = invert(e, (p - 1) * (q - 1))
m = powmod(c, d, n)
print(long_to_bytes(m))
```

#### <font style="color:rgb(0, 0, 0);">å·²çŸ¥æ˜æ–‡é«˜ä½æ”»å‡»</font>
éœ€è¦sage

[https://mirrors.aliyun.com/sagemath/win/index.html](https://mirrors.aliyun.com/sagemath/win/index.html)

mé«˜ä½å·²çŸ¥

```python
import libnum
def phase2(high_m, n, c):
    R.<x> = PolynomialRing(Zmod(n), implementation='NTL')
    m = high_m + x
    M = m((m^3 - c).small_roots()[0])
    print(libnum.n2s(int(M)))
n= 
e= 3
c= 
high_m= 

phase2(high_m, n, c) 
```

#### <font style="color:rgb(0, 0, 0);">å·²çŸ¥pé«˜ä½æ”»å‡»</font>
éœ€è¦sage

```python
n = 
p4=
e = 0x10001
pbits = 1024
kbits = pbits - p4.nbits()
print(p4.nbits())
p4 = p4 << kbits
PR.<x> = PolynomialRing(Zmod(n))
f = x + p4
roots = f.small_roots(X=2^kbits, beta=0.4)
if roots:
    p = p4+int(roots[0])
    print (n)
    print (p)
    print (n/p)
```

#### <font style="color:rgb(0, 0, 0);">AMMç®—æ³•</font>
å¥½æ–‡ç« [https://xz.aliyun.com/news/13908](https://xz.aliyun.com/news/13908)

```python

from Crypto.Util.number import *
from gmpy2 import *
import random
import math

n = 
c = 
p =    
q = 
e = 

def onemod(e, q):
    p = random.randint(1, q-1)
    while(powmod(p, (q-1)//e, q) == 1):  # (r,s)=1
        p = random.randint(1, q)
    return p

def AMM_rth(o, r, q):  # r|(q-1
    assert((q-1) % r == 0)
    p = onemod(r, q)

    t = 0
    s = q-1
    while(s % r == 0):
        s = s//r
        t += 1
    k = 1
    while((s*k+1) % r != 0):
        k += 1
    alp = (s*k+1)//r

    a = powmod(p, r**(t-1)*s, q)
    b = powmod(o, r*a-1, q)
    c = powmod(p, s, q)
    h = 1

    for i in range(1, t-1):
        d = powmod(int(b), r**(t-1-i), q)
        if d == 1:
            j = 0
        else:
            j = (-math.log(d, a)) % r
        b = (b*(c**(r*j))) % q
        h = (h*c**j) % q
        c = (c*r) % q
    result = (powmod(o, alp, q)*h)
    return result

def ALL_Solution(m, q, rt, cq, e):
    mp = []
    for pr in rt:
        r = (pr*m) % q
        # assert(pow(r, e, q) == cq)
        mp.append(r)
    return mp


def calc(mp, mq, e, p, q):
    i = 1
    j = 1
    t1 = invert(q, p)
    t2 = invert(p, q)
    for mp1 in mp:
        for mq1 in mq:
            j += 1
            if j % 100000 == 0:
                print(j)
            ans = (mp1*t1*q+mq1*t2*p) % (p*q)
            if check(ans):
                return
    return


def check(m):
    try:
        a = long_to_bytes(m)
        if b'NSSCTF' in a:
            print(a)
            return True
        else:
            return False
    except:
        return False


def ALL_ROOT2(r, q):  # use function set() and .add() ensure that the generated elements are not repeated
    li = set()
    while(len(li) < r):
        p = powmod(random.randint(1, q-1), (q-1)//r, q)
        li.add(p)
    return li

cp = c % p
cq = c % q

mp = AMM_rth(cp, e, p)  # AMMç®—æ³•å¾—åˆ°ä¸€ä¸ªè§£
mq = AMM_rth(cq, e, q)

rt1 = ALL_ROOT2(e, p)  # å¾—åˆ°æ‰€æœ‰çš„riï¼Œå³(ri*mp)^e%p = 1
rt2 = ALL_ROOT2(e, q)

amp = ALL_Solution(mp, p, rt1, cp, e)  # å¾—åˆ°æ‰€æœ‰çš„mp
amq = ALL_Solution(mq, q, rt2, cq, e)

calc(amp, amq, e, p, q)  # ä¿©ä¿©CRT
```

#### <font style="color:rgb(51, 51, 51);">å‰ªæ</font>
<font style="color:rgb(51, 51, 51);">a1^b1ï¼š</font>

```python
from Crypto.Util.number import *
import sys

sys.setrecursionlimit(1500)

# part1,å‰ªæ
a1 = 
b1 = 
c1 = 
e = 65537
a1 = "0" + str(bin(a1)[2:])


def find(p, q):
    l = len(p)
    tmp0 = p + (1024 - l) * "0"
    tmp1 = p + (1024 - l) * "1"
    tmq0 = q + (1024 - l) * "0"
    tmq1 = q + (1024 - l) * "1"
    if (int(tmp0, 2) < int(tmq0, 2)):
        return
    if (int(tmp0, 2) * int(tmq0, 2) > b1):
        return
    elif (int(tmp1, 2) * int(tmq1, 2) < b1):
        return

    if (l == 1024):
        pp = int(tmp0, 2)
        qq = int(tmq0, 2)
        d = inverse(e, (pp - 1) * (qq - 1))
        m = long_to_bytes(pow(c1, d, pp * qq))
        print(str(m)[2:-1], end="")

    else:
        if (a1[l] == "1"):
            find(p + "1", q + "0")
            find(p + "0", q + "1")
        else:
            find(p + "0", q + "0")
            find(p + "1", q + "1")


tempp = ""
tempq = ""
find(tempp, tempq)
```

<font style="color:rgb(51, 51, 51);">p ^ _qï¼š</font>

<font style="color:rgb(51, 51, 51);">pä¸qçš„åæ–¹å‘äºŒè¿›åˆ¶çš„å¼‚æˆ–å€¼</font>

```python
from Crypto.Util.number import *
import sys
sys.setrecursionlimit(1500)

pxorq = 
n =
c = 
e = 65537
pxorq = str(bin(pxorq)[2:]).zfill(256)
 
def find(ph,qh,pl,ql):
    l = len(ph)
    tmp0 = ph + (256-2*l)*"0" + pl
    tmp1 = ph + (256-2*l)*"1" + pl
    tmq0 = qh + (256-2*l)*"0" + ql
    tmq1 = qh + (256-2*l)*"1" + ql
    if(int(tmp0,2)*int(tmq0,2) > n):
        return 
    if(int(tmp1,2)*int(tmq1,2) < n):
        return
    if(int(pl,2)*int(ql,2) % (2**(l-1)) != n % (2**(l-1))):
        return

    if(l == 128):
        pp0 = int(tmp0,2)
        if(n % pp0 == 0):
            pf = pp0
            qf = n//pp0
            phi = (pf-1)*(qf-1)
            d = inverse(e,phi)
            m1 = pow(c,d,n)
            print(long_to_bytes(m1))
            exit()

    else:
        if(pxorq[l] == "1" and pxorq[255-l] == "1"):
            find(ph+"1",qh+"0","1"+pl,"0"+ql)
            find(ph+"0",qh+"0","1"+pl,"1"+ql)
            find(ph+"1",qh+"1","0"+pl,"0"+ql)
            find(ph+"0",qh+"1","0"+pl,"1"+ql)
        elif(pxorq[l] == "1" and pxorq[255-l] == "0"):
            find(ph+"1",qh+"0","0"+pl,"0"+ql)
            find(ph+"0",qh+"0","0"+pl,"1"+ql)
            find(ph+"1",qh+"1","1"+pl,"0"+ql)
            find(ph+"0",qh+"1","1"+pl,"1"+ql)
        elif(pxorq[l] == "0" and pxorq[255-l] == "1"):
            find(ph+"0",qh+"0","1"+pl,"0"+ql)
            find(ph+"0",qh+"1","0"+pl,"0"+ql)
            find(ph+"1",qh+"0","1"+pl,"1"+ql)
            find(ph+"1",qh+"1","0"+pl,"1"+ql)
        elif(pxorq[l] == "0" and pxorq[255-l] == "0"):
            find(ph+"0",qh+"0","0"+pl,"0"+ql)
            find(ph+"1",qh+"0","0"+pl,"1"+ql)
            find(ph+"0",qh+"1","1"+pl,"0"+ql)
            find(ph+"1",qh+"1","1"+pl,"1"+ql)

find("1","1","1","1")
```

## <font style="color:rgb(79, 79, 79);">DSA</font>

### åŸç†åŠåŠ è§£å¯†è¿‡ç¨‹
[https://zh.wikipedia.org/wiki/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95](https://zh.wikipedia.org/wiki/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95)

## <font style="color:rgb(79, 79, 79);">ECC</font>

### åŸç†åŠåŠ è§£å¯†è¿‡ç¨‹

## <font style="color:rgb(79, 79, 79);">AES/DES</font>

## ......

## è„šæœ¬:

```python
#!/bin/bash
# ä½œä¸ºmiscçš„é€šç”¨tools
# huihuilikaile 20250425



# è®¾ç½®é¢œè‰²ä¿¡æ¯
# åŸºæœ¬æ–‡å­—é¢œè‰²
BLACK_TEXT="\033[30m"
RED_TEXT="\033[31m"
GREEN_TEXT="\033[32m"
YELLOW_TEXT="\033[33m"
BLUE_TEXT="\033[34m"
PURPLE_TEXT="\033[35m"
CYAN_TEXT="\033[36m"
WHITE_TEXT="\033[37m"

# åŸºæœ¬èƒŒæ™¯é¢œè‰²
BLACK_BG="\033[40m"
RED_BG="\033[41m"
GREEN_BG="\033[42m"
YELLOW_BG="\033[43m"
BLUE_BG="\033[44m"
PURPLE_BG="\033[45m"
CYAN_BG="\033[46m"
WHITE_BG="\033[47m"

# äº®è‰²æ–‡å­—é¢œè‰²
BRIGHT_BLACK_TEXT="\033[1;30m"
BRIGHT_RED_TEXT="\033[1;31m"
BRIGHT_GREEN_TEXT="\033[1;32m"
BRIGHT_YELLOW_TEXT="\033[1;33m"
BRIGHT_BLUE_TEXT="\033[1;34m"
BRIGHT_PURPLE_TEXT="\033[1;35m"
BRIGHT_CYAN_TEXT="\033[1;36m"
BRIGHT_WHITE_TEXT="\033[1;37m"

# è‡ªå®šä¹‰ RGB é¢œè‰²
CUSTOM_RED_TEXT="\033[38;2;255;0;0m"
CUSTOM_GREEN_BG="\033[48;2;0;255;0m"

# ç»„åˆèƒŒæ™¯é¢œè‰²

GREEN_WHITE_TEXT="\033[1;47;32m"
BLUE_WHITE_TEXT="\033[1;34;47m"
BLUE_GREE_TEXT="\033[34;42m"
# é‡ç½®é¢œè‰²
RESET="\033[0m"

# è®¾ç½®é¢œè‰²å‡½æ•°

RED_B() {
    echo "${RED_TEXT}${1}${RESET}\n"
}

BLUE_B() {
    echo "${BLUE_TEXT}${1}${RESET}\n"
}

RED_LB() {
    echo "${BRIGHT_RED_TEXT}${1}${RESET}\n"
}

BLUE_LB() {
    echo "${BRIGHT_BLUE_TEXT}${1}${RESET}\n"
}

ALL_B() {
    echo "${BLUE_WHITE_TEXT}${1}${RESET}\n"
}

BLUE_GREE_B() {
    echo "${BLUE_GREE_TEXT}${1}${RESET}\n"
}

FENGE() {
    echo "${GREEN_TEXT}${1}${RESET}\n"
}

# è®¾ç½®å¸®åŠ©ä¿¡æ¯
usage() {
    echo "Usage: $0 [-f <arg>] [-p <arg>] [-j <arg>] [-g <arg>] [-h]"
    echo "  -f filename  æä¾›æ–‡ä»¶çš„ç±»å‹,EXIF,å…³é”®å­—æ£€æµ‹,æ–‡ä»¶éšè—(binwalk foremost)ç­‰ä¿¡æ¯"
    echo "  -p True/T/t  è¿›è¡Œpngç›¸å…³çš„æ£€æµ‹ "
    echo "  -j key  è¿›è¡Œjpgç›¸å…³çš„æ£€æµ‹ "
    echo "  -g True/T/t  è¿›è¡Œgifç›¸å…³çš„æ£€æµ‹ "
    echo "  -h è·å–å¸®åŠ©"
    exit 1
}


# ANSI è½¬ä¹‰ç å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[0;33m'
BLUE='\033[0;34m'
NC='\033[0m' # é‡ç½®é¢œè‰²

# å‡½æ•°ï¼šå°†æ–‡æœ¬æ·»åŠ å¸¦é¢œè‰²çš„è¾¹æ¡†
add_colored_border() {
  local text="$1"
  local length=${#text}
  
  # è®¡ç®—è¾¹æ¡†å®½åº¦ï¼ˆå¢åŠ ä¸€äº›é¢å¤–çš„ç©ºé—´ï¼‰
  local border_width=$((length + 4))
  
  # æ‰“å°ä¸Šè¾¹æ¡†
  printf "${BLUE_TEXT}+%0.s-" $(seq 1 $border_width)
  echo "--${NC}"
  
  # æ‰“å°æ–‡æœ¬è¡Œ
  printf "${colBLUE_TEXTor} %s ${NC}\n" "$text"
  
  # æ‰“å°ä¸‹è¾¹æ¡†
  printf "${BLUE_TEXT}+%0.s-" $(seq 1 $border_width)
  echo "--${NC}"
}

# å…³é”®å­—

CHARKEY="flag|FLAG|pass|pk|PK|Pk|ctf|CTF|KEY|key|txt|PASS"

# ç›®å½•è®¾ç½®

binwalkout="binwalkoutfile"

foremostout="foremostoutfile"

# å­—ç¬¦åŒ¹é…å‡½æ•°
grep_file() {
    outkeys=$(strings "${1}" | grep "-E" "${CHARKEY}")
    add_colored_border $outkeys
}
# æ–‡ä»¶ç±»å‹åŒ¹é…
file_type() {
    file $1
}

# exifæ•°æ®
exif_file() {
    exiftool "$1"
}



forf() {
    timefile=$(date +"%H%M%S")
    filename="${foremostout}/${timefile}_${1%%.*}"
    if [ -d $filename ]; then
        RED_LB "${RED_TEXT}ç›®å½•${filename}ä¸ä¸ºç©º,é‡æ–°åˆ›å»º:${RESET}"
        timefile=$(date +"%H%M%S")
        filename="${foremostout}/${timefile}_${1%%.*}"
        mkdir $filename
        BLUE_LB "æ–°ç›®å½•:${filename}"
        foremost "-i" "$1" "-o" "${filename}"
        FENGE "ç›®å½•æ ‘: "
        tree $filename
    else
        mkdir $filename
        
        foremost "-i" "$1" "-o" "${filename}"

        BLUE_LB "\nforemostè¾“å‡ºç›®å½•: ${filename}"

        FENGE "ç›®å½•æ ‘: "
        tree $filename
    fi
}
#------------------å›¾ç‰‡ç›¸å…³---------------------
# OurSecretéšå†™æ£€æµ‹
OurSecret_file() {
    # æ¨¡æ‹Ÿ xxd è¾“å‡º
    xxd_output=$(xxd "-p" $1)

    # å¾…æ¯”å¯¹çš„åå…­è¿›åˆ¶æ•°æ®
    target_hex="9e97ba2a008088c9a370975ba2e499b8c178720f88dddc342b4e7d317fb5e87039a8b84275687191"

    # è¿›è¡Œæ¯”å¯¹
    if echo "$xxd_output" | grep -q "$target_hex"; then
        RED_B "å¯èƒ½å­˜åœ¨OurSecret"
    else
        BLUE_LB "ä¸å­˜åœ¨OurSecretéšå†™"
    fi
}


# è®¾ç½®å‚æ•°é€‰é¡¹
while getopts ":f:p:j:g:b:h" opt; do
    case $opt in
        f)
            # BINWALK FOREMOST STRINGS GREP
            FENGE "-----------------ä¿¡æ¯æ”¶é›†-------------------"
            BLUE_GREE_B "æ–‡ä»¶ç±»å‹æ£€æµ‹:"
            file_type $OPTARG
            BLUE_GREE_B "å…³é”®å­—:"
            grep_file $OPTARG
            BLUE_GREE_B "exifæ•°æ®:"
            exif_file $OPTARG
            BLUE_GREE_B "FOREMOST åˆ†ç¦»ç»“æœ:"
            forf $OPTARG
            f_name="$OPTARG"
            
            ;;
        p)
            PTRUE=true
            FENGE "-----------------PNGç›¸å…³æ£€æµ‹-------------------"
            BLUE_GREE_B "pngå®½é«˜æ£€æµ‹:"
            pnghwout=$(python3 "pnghw.py" "-f" "${f_name}")
            BLUE_LB $pnghwout
            BLUE_GREE_B "png IDATå¿«æ£€æµ‹:"
            pngcheck "-v" "${f_name}"
            
            BLUE_GREE_B "OurSecretéšå†™æ£€æµ‹:"
            OurSecret_file $f_name
            ;;
        j)
            BLUE_GREE_B "OurSecretéšå†™æ£€æµ‹:"
            OurSecret_file $f_name
            BLUE_GREE_B "steghideæœªçŸ¥å¯†ç éšå†™æ£€æµ‹:"
            steghide "extract" "-sf" $f_name
            BLUE_GREE_B "outguesséšå†™æ£€æµ‹:"
            outguess "-k" "$OPTARG" "-r"  $f_name "${f_name%%.*}.txt"
            BLUE_LB "è¾“å‡ºæ–‡ä»¶ä¸ºï¼š${f_name%%.*}.txt"
            ;;
        g)
            BLUE_B "Option c$OPTARG"
            ;;
        g)
            BLUE_B "Option c$OPTARG"
            ;;
	    h)
	        usage
	        ;;
        \?)
            RED_LB "æœªçŸ¥é€‰é¡¹: -$OPTARG" >&2
            ;;
        :)
            RED_LB "æä¾›ç»™ -$OPTARG é€‰é¡¹ä¸€ä¸ªå‚æ•°." >&2
            ;;
    esac
done 
FENGE "-----------------å‚¨å­˜èµ„æ–™-------------------"
cat "www.txt"
if [ "$PTRUE" = true ]; then
    BLUE_GREE_B "æ‰§è¡Œzsteg: "
    zsteg "-a" "$f_name"
fi

```

1, 47);background-color:#FFFFFF;">ä½¿ç”¨Image Steganography decrypt</font>

npietç¼–ç¨‹è¯­è¨€ï¼š

[https://www.bertnase.de/npiet/npiet-execute.php](https://www.bertnase.de/npiet/npiet-execute.php)

<font style="color:rgb(85, 85, 85);">å°†ä¿¡æ¯éšå†™åœ¨å›¾ç‰‡</font>

[https://stylesuxx.github.io/steganography/](https://stylesuxx.github.io/steganography/)

[https://www.a.tools/Tool.php?Id=100](https://www.a.tools/Tool.php?Id=100)

å…‰æ …å›¾åƒï¼š

[https://github.com/AabyssZG/Raster-Terminator](https://github.com/AabyssZG/Raster-Terminator)

å·¥å…·ç«™ï¼š[https://tools.jb51.net/aideddesign/img_add_info](https://tools.jb51.net/aideddesign/img_add_info)

DeEgger Embedderéšå†™ <font style="color:rgb(22, 18, 9);">DeEgger Embedderå·¥å…·</font>

<font style="color:rgb(22, 18, 9);">æŠŠå°è¯´è—è¿›å›¾ç‰‡ å¯ä»¥å‚è€ƒ</font>[https://www.bilibili.com/video/BV1Ai4y1V7rg/?spm_id_from=333.999.0.0&vd_source=31399c09aa0c93655468bde7b13fcc03](https://www.bilibili.com/video/BV1Ai4y1V7rg/?spm_id_from=333.999.0.0&vd_source=31399c09aa0c93655468bde7b13fcc03)

ArnoldçŒ«è„¸å˜æ¢ï¼š

åŸç†ï¼š[https://www.jianshu.com/p/39727dbaffd9](https://www.jianshu.com/p/39727dbaffd9)

ä¸€ä¸ªç½‘ä¸Šçš„è„šæœ¬ï¼š

```python
from PIL import Image

def arnold(infile: str, outfile: str = None, a: int = 1, b: int = 1, shuffle_times: int = 1, reverse: bool = False) -> None:
    """
    ArnoldçŒ«è„¸å˜æ¢å‡½æ•°

    Parameters:
        infile - è¾“å…¥å›¾åƒè·¯å¾„
        outfile - è¾“å‡ºå›¾åƒè·¯å¾„
        a - Anrold å˜æ¢å‚æ•°
        b - Anrold å˜æ¢å‚æ•°
        shuffle_times - ç½®ä¹±æ¬¡æ•°
        reverse - é€†å˜æ¢
    """
    inimg = Image.open(infile)
    width, height = inimg.size
    indata = inimg.load()
    outimg = Image.new(inimg.mode, inimg.size)
    outdata = outimg.load()

    for _ in range(shuffle_times):
        for x in range(width):
            for y in range(height):
                if reverse:
                    nx = ((a * b + 1) * x - a * y) % width
                    ny = (y - b * x) % height
                else:
                    nx = (x + a * y) % width
                    ny = (b * x + (a * b + 1) * y) % height
                outdata[ny, nx] = indata[y, x]
    
    outimg.save(outfile if outfile else "arnold_"+infile, inimg.format)

arnold("before.png", "encode.png", 9, 39, 1)
arnold("encode.png", "decode.png", 9, 39, 1, True)

```

é€šå¸¸ç»™a bæ•°æ®å¯èƒ½ç»™n 

äºŒè¿›åˆ¶æ•°æ®/rgbæ•°æ®è½¬å›¾ç‰‡:

å›¾åƒé€†åºï¼š

```python
infile = 'int.png'
outfile = 'out.png'

with open(infile, "rb") as fin:
    with open(outfile, "wb") as fout:
        fout.write(fin.read()[::-1])

```

#### png
**å®½é«˜ï¼š**

**é¢˜ç›®ä¼šé€šè¿‡ä¿®æ”¹æ–‡ä»¶çš„å®½é«˜æ•°æ®ä½æ¥éšè—ä¸€äº›ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ¯”å¯¹crcä½å¾—åˆ°æ­£ç¡®çš„å®½é«˜å€¼**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750225698908-b103c10e-eb2e-4201-bddb-c2d936fc6fa4.png)

è¿™æ˜¯ä¸€ä¸ªä¿®æ”¹è¿‡å®½é«˜çš„å›¾ç‰‡çš„æˆªå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»…ä»…æœ‰ä¸€å¥è¯å…¶ä»–ä»€ä¹ˆä¹Ÿæ²¡æœ‰

è€Œå½“æˆ‘ä»¬æ­£ç¡®çš„ä¿®æ”¹å®½é«˜åå°±å¯ä»¥çœ‹åˆ°éšè—åœ¨å³ä¸‹è§’çš„flagå€¼

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750225802383-8794f857-21e4-40da-a9f3-96f54a4f7b33.png)

é€šå¸¸é‡åˆ°æ¯”ä¾‹å¥‡æ€ªçš„å›¾ç‰‡æˆ‘ä»¬éƒ½å¯ä»¥å°è¯•æ‰‹åŠ¨ä¿®æ”¹å®½é«˜

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750225899833-a5bdd2ac-e35a-4715-a381-dd0c74de1eaa.png)

1 å¤„å³ä¸º å®½åº¦æ•°æ® 2 å¤„ä¸ºé«˜åº¦æ•°æ® åœˆèµ·æ¥çš„åœ°æ–¹ä¸ºcrcæ•°æ®

å½“å°è¯•å‘ç°å¯èƒ½è¢«ä¿®æ”¹å®½é«˜åå¯ä»¥ä½¿ç”¨pythonè„šæœ¬æ£€æµ‹æ˜¯å¦ä¿®æ”¹äº†å®½é«˜å¹¶ä¿®å¤å¾—åˆ°æ­£ç¡®å®½é«˜çš„å›¾ç‰‡

```python
import binascii
import itertools
import os
import struct
import zlib
import click


@click.command()
@click.option("-f","--file", required=True,help="file path")

def png_hw(file):
    # ä¿®å¤png
    def modify_file_hex(file, position, new_hex_value):
                            try:
                                with open(file, 'rb') as f:
                                    content = f.read()
                                    hex_content = binascii.hexlify(content).decode()
                                    new_hex_content = hex_content[:position] + new_hex_value + hex_content[48:]
                                    modified_content = binascii.unhexlify(new_hex_content)
                                    output_file = os.path.join(os.path.dirname(file),
                                                                    'png_h_w_' + os.path.basename(file))
                                    with open(output_file, 'wb') as out_f:
                                        out_f.write(modified_content)
                                    return output_file
                            except FileNotFoundError:
                                return "æ–‡ä»¶ä¸å­˜åœ¨"
    try:
        png_data = open(f'{file}', 'rb').read()
        if png_data[:6].hex() != '89504e470d0a':
            print(f'épngæ–‡ä»¶')
        else:
            crc32key = zlib.crc32(png_data[12:29])  
            re_crc32 = int(png_data[29:33].hex(), 16) # åŸå§‹crc32å€¼
            width = struct.unpack('>i', png_data[16:20])[0]
            height = struct.unpack('>i', png_data[20:24])[0]
            print(f'æ–‡ä»¶å®½åº¦ï¼š{width}, æ–‡ä»¶é«˜åº¦ï¼š{height}')
            if crc32key == re_crc32:  
                print('æ–‡ä»¶å®½é«˜æ­£ç¡®')
            else:
                print('æ–‡ä»¶å®½é«˜ä¸æ­£ç¡®ï¼Œæ­£åœ¨çˆ†ç ´å®½é«˜')
                for i, j in itertools.product(range(4095),
                                                range(
                                                    4095)):  
                    data = png_data[12:16] + struct.pack('>i', i) + struct.pack('>i', j) + png_data[24:29]
                    crc32 = zlib.crc32(data)
                    if crc32 == re_crc32:  
                        position = 32  
                        def pad_to_eight(s):
                            while len(s) < 8:
                                s = '0' + s
                            return s
                        w_out = pad_to_eight(hex(i)[2:])
                        h_out = pad_to_eight(hex(j)[2:])
                        new_hex_value = w_out + h_out
                        output_path = modify_file_hex(file, position, new_hex_value)
                        if output_path:
                            print(f'æ–‡ä»¶è¾“å‡ºåœ¨{output_path}')
                        else:
                            print(f'æ–‡ä»¶é”™è¯¯')
    except ValueError:
        print("æ–‡ä»¶ error")
if __name__ == "__main__":
    png_hw()
```

**è¿è¡Œï¼š**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750226142647-a19ff46a-da10-497b-b656-08860b14c8d4.png)

**æ–‡ä»¶åˆ†ç¦»ï¼š**

**binwalk**

è¿™å·¥å…·kaliè‡ªå¸¦ï¼Œå¯ä»¥åœ¨è™šæ‹Ÿæœºå®‰è£…ä¸€ä¸ªkali

kali: [https://www.kali.org/get-kali/#kali-virtual-machines](https://www.kali.org/get-kali/#kali-virtual-machines)

vmè™šæ‹Ÿæœºï¼š[https://www.vmware.com/products/desktop-hypervisor/workstation-and-fusion](https://www.vmware.com/products/desktop-hypervisor/workstation-and-fusion)

vmä¸‹è½½éœ€è¦æ³¨å†Œï¼Œæ³¨å†Œå¥½æ— æ³•ç™»å½•å»è¿™é‡Œçš„mydownloads

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750226832605-2f428c4a-0442-42ae-8d20-98bda2d2eab9.png)

**ç”¨æ³•ï¼š**

```shell
binwalk -e filename
```

**foremost:**

> sudo apt install foremost -y  # å®‰è£…foremost
>

**ç”¨æ³•ï¼š**

```shell
foremost -i filename -o outpath
```

**ç›²æ°´å°ï¼š**

**å•å›¾ç›²æ°´å°ï¼šå¯ä»¥ä½¿ç”¨å¦‚ä¸‹è½¯ä»¶**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750227659203-a6b9f18a-7544-452e-9fd8-5d823664dd31.png)

[**https://www.123912.com/s/f2HzTd-9cz03**](https://www.123912.com/s/f2HzTd-9cz03)**æå–ç :FHgq**

**è¿˜æœ‰ä¸€ä¸ªjavaç›²æ°´å°å·¥å…· **[**https://github.com/ww23/BlindWatermark**](https://github.com/ww23/BlindWatermark)

**java -jar BlindWatermark-v0.0.3-windows-x86_64-gpu.jar decode -c gakki-dct-text-ec.jpg gakki-dct-text-dc.jpg**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750228630153-63c0463d-99e7-40a1-8677-19e0ba88161f.png)

**åŒå›¾ç›²æ°´å°ï¼š**

**å·¥å…·githubåœ°å€ï¼š**

[**https://github.com/chishaxie/BlindWaterMark#blindwatermark**](https://github.com/chishaxie/BlindWaterMark#blindwatermark)

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750228030031-36c0e674-96af-4199-844e-0bd2291f6c4d.png)

å¦ä¸€ä¸ªguiåŒ–çš„[https://github.com/fire-keeper/BlindWatermark](https://github.com/fire-keeper/BlindWatermark)

lsbéšå†™ï¼š

åœ¨pngå›¾ç‰‡ä¸­ï¼ŒåŒ…å«256çš„ä¸‰æ¬¡æ–¹ä¸ªé¢œè‰²ï¼Œå³16777216ç§ï¼Œäººç±»çš„çœ¼ç›å¯ä»¥åŒºåˆ†çº¦1,000ä¸‡ç§ä¸åŒçš„é¢œè‰²ï¼Œå‰©ä¸‹æ— æ³•åŒºåˆ†çš„é¢œè‰²å°±æœ‰6777216

LSBéšå†™å°±æ˜¯ä¿®æ”¹RGBé¢œè‰²åˆ†é‡çš„æœ€ä½äºŒè¿›åˆ¶ä½ä¹Ÿå°±æ˜¯æœ€ä½æœ‰æ•ˆä½ï¼ˆLSBï¼‰ï¼Œè€Œäººç±»çš„çœ¼ç›ä¸ä¼šæ³¨æ„åˆ°è¿™å‰åçš„å˜åŒ–ï¼Œæˆ‘ä»¬ä»…å¯¹RGBä¸­çš„æœ€ä½ä½è¿›è¡Œä¿®æ”¹ï¼Œå¦‚å½“å‰åƒç´ ä½ç‚¹æœ€åä¸€ä½ä¿®æ”¹æˆ1,1ï¼Œ0.åˆ™ä¸Šè¿°RGBå˜æˆ218->219ï¼š

ä¸Šè¿°å˜åŒ–å¾ˆéš¾ç”¨è‚‰çœ¼å¯Ÿè§‰åˆ°ï¼Œè€Œä¸”æ¯ä¸€ä¸ªåƒç´ ä½ç‚¹æºå¸¦äº†ä¸€ä½ä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…«ä¸ªå­—èŠ‚çš„æœ€ä½ä½å­˜å‚¨ä¸€ä¸ªæ¯”ç‰¹ä¿¡æ¯ï¼Œè€Œè¯¥æ¯”ç‰¹ä¿¡æ¯åˆ™å¯ä»¥è½¬åŒ–ä¸ºASCIIå­—ç¬¦ï¼Œä»è€Œè¾¾åˆ°éšå†™ä¿¡æ¯çš„ç›®çš„

**zsteg:**

> å®‰è£…ï¼š
>
> githubåœ°å€ [https://github.com/zed-0xff/zsteg](https://github.com/zed-0xff/zsteg)
>
> gem install zsteg
>

**ä¸»è¦ç”¨æ¥æ£€æµ‹pngçš„lsbéšå†™ï¼Œwbstego**

**StegSolve:**

**åŒæ ·å¯ä»¥æŸ¥çœ‹lsbï¼Œå¯ä»¥æŸ¥çœ‹jpg...**

**åœ¨é‡åˆ°é¢˜ç›®ç»™ä¸¤å¼ å›¾ç‰‡çš„æ—¶å€™äº¦å¯ä»¥ä½¿ç”¨ä»–è¿›è¡ŒåŒå›¾xorç­‰**

**IDAT å—:**

**æŸ¥çœ‹idatå—æ˜¯å¦æ­£ç¡®ï¼Œæ˜¯å¦æœ‰å¤šä½™çš„ï¼Œå¯èƒ½ä¸ºåˆ«çš„å›¾åƒçš„æ•°æ®å—**

```shell
pngcheck file
```

#### jpg
**<font style="color:rgb(22, 18, 9);">OurSecretéšå†™ï¼š</font>**

**<font style="color:rgb(22, 18, 9);">ç‰¹å¾æ˜æ˜¾ï¼Œæœ‰å¦‚ä¸‹æ•°æ®</font>**

```shell
9E 97 BA 2A 00 80 88 C9 A3 70 97 5B A2 E4 99 B8
C1 78 72 0F 88 DD DC 34 2B 4E 7D 31 7F B5 E8 70
39 A8 B8 42 75 68 71 91

```

æœ‰å¯†ç ï¼Œå¯ä»¥æ— å¯†ç 

**stegdetect:**

stegdetect.exe -t jopi -s 10.0 1.jpg

æ£€æµ‹åŠ å¯†

**silenteyeï¼š**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750231191904-f3d178e3-76b7-4707-acff-2a99905bf82a.png)

**steghideï¼š**

```bash
steghide extract -sf filename -p passwd
```

**<font style="color:rgb(44, 63, 81);">JPHSï¼š</font>**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750231214798-d09b16fc-f243-48c2-aa00-529fd548a942.png)

**<font style="color:rgb(85, 85, 85);">outguessï¼š</font>**

```bash
outguess -k "pass" -r 1.jpg flag.txt
#-k å¯†é’¥
#flag.txt ä¿å­˜ä½ç½®
```

**<font style="color:rgb(85, 85, 85);">pixeljihadï¼š</font>**

**<font style="color:rgb(85, 85, 85);">åœ¨çº¿ï¼š</font>**[**https://sekao.net/pixeljihad/**](https://sekao.net/pixeljihad/)

**F5-steganography:**

```bash
#æœ‰å¯†ç 
java Extract 1.jpg -p passwd
#æ— å¯†ç 
java Extract 1.jpg
#æ•°æ®ä¼šæ”¾åˆ°F5æ–‡ä»¶å¤¹çš„output.txt

```

**JPGå®½é«˜éšå†™:**

**å› ä¸ºjpgå’Œpngä¸åŒï¼Œæ— æ³•çˆ†ç ´crcç¡®å®šæ­£ç¡®çš„å®½é«˜åªèƒ½æ‰‹åŠ¨ä¿®æ”¹**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1750231409809-e60de58c-012e-46e8-becf-a4fd75b872ba.png)

#### bmp
**å®½é«˜ï¼š**

å¯ä»¥ä½¿ç”¨gimpä¿®æ”¹

bmpæ–‡ä»¶å¤´å»æ‰

**<font style="color:rgb(36, 41, 47);background-color:#FFFFFF;">silenteyeï¼šåŒä¸Šé¢çš„jpg</font>**

**<font style="color:rgb(36, 41, 47);background-color:#FFFFFF;">wbStego4open: åŒä¸Š</font>**

#### gif
**gifåˆ†ç¦»ï¼š**

```shell
convert flag.gif flag.png
```

**å¸§é—´éš”ï¼š**

```bash
identify -format "%s %T \n" flag.gif 
```

#### ......

### éŸ³è§†é¢‘éšå†™
[https://www.123912.com/s/f2HzTd-ZhL03](https://www.123912.com/s/f2HzTd-ZhL03)æå–ç :LCtD

#### wav
**<font style="color:rgb(36, 41, 47);">silenteye:</font>**

<font style="color:rgb(36, 41, 47);">å¯èƒ½æ˜¯silenteyeéšå†™,ä½¿ç”¨å¦‚åŒjpgï¼Œæœ‰å¯†åŒ™ä½¿ç”¨å¯†åŒ™è§£</font>

**<font style="color:rgb(36, 41, 47);">deepsoundï¼š</font>**

ä½¿ç”¨deepsound æ‰“å¼€ï¼Œå¦‚æœéœ€è¦å¯†ç è¯´æ˜å°±æ˜¯ deepsound éšå†™ï¼Œæœ‰å¯†é’¥ç›´æ¥å¡«å…¥å¯†é’¥è§£å¯†å³å¯

å¦‚æœæ˜¯ deepsound éšå†™ä½†æ²¡æœ‰å¯†é’¥ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯æœ‰ä½¿ç”¨deepsound2johnè„šæœ¬è·å–wavæ–‡ä»¶çš„å“ˆå¸Œå€¼

ç„¶åç”¨johnçˆ†ç ´hash

ç”¨æ³•: john 1.txt

> https://github.com/openwall/john/blob/bleeding-jumbo/run/deepsound2john.py
>

**sstvï¼š**

å·¥å…·ï¼š[https://github.com/colaclanth/sstv](https://github.com/colaclanth/sstv)

å¯ä»¥ä½¿ç”¨rx-sstv

ä¹Ÿå¯ä»¥ä½¿ç”¨é›†æˆçš„å·¥å…·

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752725113336-51e85718-bce8-45c3-8c4e-38b9775ca8e3.png)

**<font style="color:rgb(22, 18, 9);">ç”µè¯éŸ³åˆ†æ(DTMF)ï¼š</font>**

<font style="color:rgb(22, 18, 9);">ä½¿ç”¨å·¥å…·ï¼šdtmf2num.exe</font>

<font style="color:rgb(22, 18, 9);">ç”¨æ³•ï¼šdtmf2num.exe xxx.wav</font>

**<font style="color:rgb(22, 18, 9);">Audacityï¼š</font>**

<font style="color:rgb(22, 18, 9);">ä½¿ç”¨Audacity.exeæ‰“å¼€æŸ¥çœ‹æ˜¯å¦æœ‰å­—ç¬¦ä¸²ç­‰ä¿¡æ¯</font>

**<font style="color:rgb(22, 18, 9);">steghideï¼š</font>**

<font style="color:rgb(22, 18, 9);">ä¹Ÿå¯èƒ½æ˜¯steghide</font>

<font style="color:rgb(22, 18, 9);">ç”¨æ³•ï¼š</font>

```bash
steghide extract -sf filename -p passwd
```

#### mp3
**<font style="color:rgb(22, 18, 9);">mp3stegoï¼š</font>**

<font style="color:rgb(22, 18, 9);">å·¥å…·åœ°å€ï¼š</font>[https://www.petitcolas.net/steganography/mp3stego/](https://www.petitcolas.net/steganography/mp3stego/)

ç”¨æ³•ï¼š

> decode -X -P pass sound.mp3     
> -X æ˜¯æå–å‡ºéšå†™çš„æ–‡ä»¶  
> passæ˜¯è§£å¯†æ—¶éœ€è¦çš„å¯†ç    
> sound.mp3æ˜¯å¾…å¤„ç†çš„MP3æ–‡ä»¶  
> # mp3stegoå¯ä»¥ä½¿ç”¨æ— å¯†ç è¿›è¡Œéšå†™
>

**stegpyï¼š**

```bash
stegpy 1.wav -p
```

**<font style="color:rgb(22, 18, 9);">DeEgger Embedderï¼š</font>**

<font style="color:rgb(22, 18, 9);">åœ°å€ï¼š</font>[https://www.softpedia.com/get/Security/Encrypting/DeEgger-Embedder.shtml](https://www.softpedia.com/get/Security/Encrypting/DeEgger-Embedder.shtml)

### æ–‡æ¡£ç±»éšå†™

#### pdf
**åµŒå…¥æ–‡ä»¶ï¼š**

ä½¿ç”¨binwalk æˆ–è€… foremost

**<font style="color:rgb(36, 41, 47);">wbStego4open:</font>**

<font style="color:rgb(22, 18, 9);">ä½¿ç”¨</font><font style="color:rgb(36, 41, 47);">wbStego4open</font><font style="color:rgb(22, 18, 9);">å¸¦å¯†é’¥</font>

**<font style="color:rgb(22, 18, 9);">æœ‰å¯†ç ï¼š</font>**

<font style="color:rgb(22, 18, 9);">ä½¿ç”¨pdfcrackçˆ†ç ´å¯†ç ï¼ˆUbuntu: apt install pdfcrackï¼‰</font>

```bash
pdfcrack -f enc.pdf -w rockyou.txt
```

#### word
å¯èƒ½å°†æ–‡å­—éšè—ï¼Œå…¨é€‰ä¿®æ”¹èƒŒæ™¯å’Œå­—ä½“é¢œè‰²å³å¯çœ‹åˆ°éšè—çš„

ä½¿ç”¨binwalkåˆ†ç¦»é™„åŠ çš„æ–‡ä»¶

åˆ©ç”¨è¡Œè·éšå†™å°†è¡Œè·çš„ä¸ç”¨è½¬åŒ–ä¸º01è§£æ‘©æ–¯å¯†ç ï¼ˆå¦‚ï¼š<font style="color:rgb(22, 18, 9);">ISCC2023-æ±¤å§†å†é™©è®° </font>ï¼‰

#### ppt
æœ€å¸¸è§çš„binwalkåˆ†ç¦»

#### excel
<font style="color:rgb(22, 18, 9);">ä½¿ç”¨è®°äº‹æœ¬æ‰“å¼€æŸ¥æ‰¾flag</font>

<font style="color:rgb(22, 18, 9);">æŸ¥çœ‹å•å…ƒæ ¼çš„ä¸åŒï¼Œå°†ä¸åŒçš„æ ¼åˆ†åˆ«è½¬åŒ–ä¸ºé»‘ç™½æ ¼ç»„æˆäºŒç»´ç </font>

<font style="color:rgb(22, 18, 9);">binwalk</font>

#### ......

### æ–‡æœ¬ç±»éšå†™

#### é›¶å®½
é›¶å®½éšå†™æ˜¯ä¸€ç§åˆ©ç”¨é›¶å®½åº¦å­—ç¬¦åœ¨æ–‡æœ¬ä¸­éšè—ä¿¡æ¯çš„æŠ€æœ¯ï¼Œè¿™äº›å­—ç¬¦åœ¨è§†è§‰ä¸Šä¸å¯è§ï¼Œä½†å¯ä»¥å­˜å‚¨å’Œä¼ é€’éšç§˜ä¿¡æ¯ã€‚

å¯ä»¥ä½¿ç”¨åœ¨çº¿ç½‘ç«™ï¼š

[https://tool.bfw.wiki/tool/1695021695027599.html](https://tool.bfw.wiki/tool/1695021695027599.html)

[https://www.hanloth.cn/tool/zero-width-secret](https://www.hanloth.cn/tool/zero-width-secret)

æˆ–è€…é›†æˆå·¥å…·ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752726462853-d166bc78-1150-4ae1-a05a-55c02deb39e8.png)

#### baseéšå†™
**å¯ä»¥ä½¿ç”¨é›†æˆå·¥å…·ï¼š**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752726579560-89fc51c7-029d-43cd-acce-214b48528f67.png)

#### ......
**<font style="color:rgb(22, 18, 9);">snowéšå†™ï¼š</font>**

<font style="color:rgb(22, 18, 9);">SNOW.EXE -C -p password flag.txt </font>

**<font style="color:rgb(22, 18, 9);">åƒåœ¾é‚®ä»¶éšå†™(spammimic)ï¼š</font>**

<font style="color:rgb(22, 18, 9);">ä½¿ç”¨åœ¨çº¿ç½‘ç«™è§£å¯†ï¼š</font>

[<font style="color:rgb(35, 118, 183);">https://www.spammimic.com/</font>](https://www.spammimic.com/)

**æ–‡å­—éšå†™ï¼š**

åœ¨çº¿ç½‘ç«™ï¼š

[https://toolshu.com/hide-text](https://toolshu.com/hide-text)

### ......

## æµé‡åˆ†æ
ä½¿ç”¨Wireshark.exeæ‰“å¼€ç›´æ¥æœç´¢

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752726760518-dc6ab77c-2709-4d3e-a171-cb3f24b4cee0.png)

æˆ–è€…å¯¼å‡ºæ–‡ä»¶

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752726835375-1cb334d9-8019-40c9-886e-6faa7cb4fe46.png)

## å–è¯é¢˜åˆ†æ
ä½¿ç”¨volè§£æ

## å‹ç¼©åŒ…é¢˜åˆ†æ

### ä¼ªåŠ å¯†

```python
ZIPä¼ªåŠ å¯†æ˜¯ä¸€ç§é€šè¿‡ä¿®æ”¹ZIPæ–‡ä»¶å¤´éƒ¨çš„åŠ å¯†æ ‡å¿—ä½ï¼Œä½¿æ–‡ä»¶è¢«è¯†åˆ«ä¸ºåŠ å¯†å‹ç¼©åŒ…çš„æŠ€æœ¯ã€‚å®é™…ä¸Šï¼Œè¿™ç§åŠ å¯†å¹¶ä¸çœŸæ­£ä¿æŠ¤æ–‡ä»¶å†…å®¹ï¼Œå› æ­¤è¢«ç§°ä¸ºâ€œä¼ªåŠ å¯†â€ã€‚ä»¥ä¸‹æ˜¯ZIPä¼ªåŠ å¯†çš„åŸç†åŠå…¶å¤„ç†æ–¹æ³•ã€‚

ZIPæ–‡ä»¶ç»“æ„ä¸ä¼ªåŠ å¯†åŸç†

ä¸€ä¸ªZIPæ–‡ä»¶é€šå¸¸ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š

å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼šåŒ…å«æ–‡ä»¶çš„å®é™…æ•°æ®ã€‚

å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼šè®°å½•æ–‡ä»¶çš„å…ƒä¿¡æ¯ã€‚

å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼šæ ‡è®°ç›®å½•çš„ç»“æŸã€‚

åœ¨ZIPæ–‡ä»¶ä¸­ï¼ŒåŠ å¯†å±æ€§ç”±â€œå…¨å±€æ–¹å¼ä½æ ‡è®°â€å†³å®šï¼š

æ— åŠ å¯†ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º00 00ã€‚

ä¼ªåŠ å¯†ï¼šæ•°æ®åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º00 00ï¼Œä½†ç›®å½•åŒºçš„æ ‡è®°è¢«ä¿®æ”¹ä¸º09 00ã€‚

çœŸåŠ å¯†ï¼šæ•°æ®åŒºå’Œç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°å‡ä¸º09 00ã€‚

ä¼ªåŠ å¯†çš„æ ¸å¿ƒåœ¨äºä¿®æ”¹ç›®å½•åŒºçš„æ ‡è®°ï¼Œä½¿å…¶æ˜¾ç¤ºä¸ºåŠ å¯†çŠ¶æ€ï¼Œä½†å®é™…æ•°æ®å¹¶æœªåŠ å¯†ã€‚
```

ç›´æ¥ä½¿ç”¨é›†æˆå·¥å…·

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752727513475-9c47a687-f1b9-45fc-bd50-161b3b61c249.png)

### çˆ†ç ´
**archpr:**

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1752727604255-934f859f-f00d-4df1-95d5-bbc13f0cf198.png)

### æ˜æ–‡çˆ†ç ´
ä¹Ÿå¯ä½¿ç”¨ä¸Šè¿°å·¥å…·

è¦æ±‚ï¼š

<font style="color:rgb(51, 51, 51);">è‡³å°‘å·²çŸ¥æ˜æ–‡çš„12ä¸ªå­—èŠ‚åŠåç§»ï¼Œå…¶ä¸­è‡³å°‘8å­—èŠ‚éœ€è¦è¿ç»­ã€‚</font>

<font style="color:rgb(51, 51, 51);">æ˜æ–‡å¯¹åº”çš„æ–‡ä»¶åŠ å¯†æ–¹å¼ä¸ºZipCrypto Store</font>

**<font style="color:rgb(51, 51, 51);">bkcrack:</font>**

[https://github.com/kimci86/bkcrack](https://github.com/kimci86/bkcrack)

### crcçˆ†ç ´
<font style="color:rgb(22, 18, 9);">å‹ç¼©åŒ…ä¸­æ–‡ä»¶æ¯”è¾ƒå°åªæœ‰å‡ å­—èŠ‚</font>

<font style="color:rgb(22, 18, 9);">å·¥å…·ï¼š</font>

[https://github.com/AabyssZG/CRC32-Tools](https://github.com/AabyssZG/CRC32-Tools)

[https://github.com/theonlypwner/crc32](https://github.com/theonlypwner/crc32)

### ......

# CRYPTO

## RSA

### RSAåŸºç¡€ç†è®ºåŠåŠ è§£å¯†è¿‡ç¨‹
å·¥å…·é›†æˆäº†ä¸€äº›å¸¸è§çš„rsaæ”»å‡»æ–¹å¼ åªéœ€è¦äº†è§£ç›¸å…³æ”»å‡»å³å¯ä½¿ç”¨

![](https://cdn.nlark.com/yuque/0/2025/png/46821499/1753933177946-d2a90513-cc04-4aa2-be1f-53606026646e.png)

<font style="color:rgb(32, 33, 34);">å¯¹æå¤§æ•´æ•°åš</font>[<font style="color:rgb(51, 102, 204);">å› æ•°åˆ†è§£</font>](https://zh.wikipedia.org/wiki/%E5%9B%A0%E6%95%B0%E5%88%86%E8%A7%A3)<font style="color:rgb(32, 33, 34);">çš„éš¾åº¦å†³å®šäº† RSA ç®—æ³•çš„å¯é æ€§ã€‚æ¢è¨€ä¹‹ï¼Œå¯¹ä¸€æå¤§æ•´æ•°åšå› æ•°åˆ†è§£æ„ˆå›°éš¾ï¼ŒRSA ç®—æ³•æ„ˆå¯é ã€‚å‡å¦‚æœ‰äººæ‰¾åˆ°ä¸€ç§å¿«é€Ÿå› æ•°åˆ†è§£çš„ç®—æ³•çš„è¯ï¼Œé‚£ä¹ˆç”¨ RSA åŠ å¯†çš„ä¿¡æ¯çš„å¯é æ€§å°±ä¼šæåº¦ä¸‹é™ã€‚ä½†æ‰¾åˆ°è¿™æ ·çš„ç®—æ³•çš„å¯èƒ½æ€§æ˜¯éå¸¸å°çš„ã€‚ä»Šå¤©åªæœ‰çŸ­çš„ RSA é’¥åŒ™æ‰å¯èƒ½è¢«å¼ºåŠ›æ–¹å¼ç ´è§£ã€‚åˆ°2020å¹´ä¸ºæ­¢ï¼Œä¸–ç•Œä¸Šè¿˜æ²¡æœ‰ä»»ä½•å¯é çš„æ”»å‡»RSAç®—æ³•çš„æ–¹å¼ã€‚åªè¦å…¶é’¥åŒ™çš„é•¿åº¦è¶³å¤Ÿé•¿ï¼Œç”¨RSAåŠ å¯†çš„ä¿¡æ¯å®é™…ä¸Šæ˜¯ä¸èƒ½è¢«ç ´è§£çš„ã€‚</font>

ç»´åŸºç™¾ç§‘ï¼š

[https://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95](https://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95)

pythonçš„ç®€å•å®ç°ï¼š

```python
from Crypto.Util.number import getPrime, inverse, bytes_to_long, long_to_bytes

flag =  b'flag{RSA}'

# ç”Ÿæˆ1024ä½çš„ç´ æ•°på’Œq

p = getPrime(1024)
q = getPrime(1024)

# è®¡ç®—n, e, phi, då’Œc
n = p * q

e = 65537

phi = (p - 1) * (q - 1)

assert GCD(e, phi) == 1, "è¯¥eä¸æ»¡è¶³äº’ç´ æ¡ä»¶"

d = inverse(e, phi)

c = pow(bytes_to_long(flag), e, n)

m = pow(c, d, n)

print(f'n = {n}')
print(f'e = {e}')   
print(f'd = {d}')
print(f'c = {c}')
print(f'm = {long_to_bytes(m)}')
```

rsaé¢˜ç›®å¸¸è§çš„å‚æ•° 

p ç´ æ•°ç”Ÿæˆn

q ç´ æ•°ç”Ÿæˆn

pq æ˜¯è§£é¢˜çš„å…³é”® é€šå¸¸è¦æ±‚çš„å‚æ•°

n ä¸eç»„æˆå…¬é’¥

e ä¸nç»„æˆå…¬é’¥

c åŠ å¯†åçš„å¯†æ–‡

phi nçš„æ¬§æ‹‰ =(p-1)*(q-1) pq = n p+q pq -p -q +1 = pq - (p+q) + 1 

d  ç§é’¥ è§£é¢˜çš„å…³é”®

m æ˜æ–‡

é€šå¸¸é¢˜ç›®ä¼šç»™ n e c 

æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸‰ä¸ªå‚æ•°æ¥åˆ¤æ–­ä½¿ç”¨é‚£äº›æ”»å‡»æ–¹å¼

ä¸€å¼€å§‹æˆ‘ä»¬å¯ä»¥å°è¯•åˆ†è§£Nï¼Œå¦‚æœnä¸å¤§

[http://www.factordb.com/](http://www.factordb.com/)

è¿™æ˜¯ä¸€ä¸ªè®°å½•äº†å¾ˆå¤šå·²ç»è¢«åˆ†è§£çš„nçš„pq

æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨yafuåˆ†è§£ï¼Œå¦‚æœpqç›¸å·®è¾ƒå¤§æˆ–å°çš„æ—¶å€™ï¼Œå¯ä»¥æ ¹æ®é¢˜ç›®æ‰€ç»™åŠ å¯†ä»£ç åˆ¤æ–­

[https://sourceforge.net/projects/yafu/](https://sourceforge.net/projects/yafu/)

æˆ‘ä»¬è¿˜éœ€è¦å­¦ä¹ ä¸€äº›pythonåº“

Crypto

gmpy2

### å¸¸è§æ”»å‡»æ–¹å¼

#### <font style="color:rgb(0, 0, 0);">å°æ˜æ–‡æ”»å‡»</font>
å½“é¢˜ç›®ä¸­Nç‰¹åˆ«å¤§çš„æ—¶å€™å¯ä»¥å°è¯•

æˆ‘ä»¬å·²çŸ¥ â… :  C  <font style="color:rgb(0, 0, 0);">â‰¡</font>![image](https://cdn.nlark.com/yuque/__latex/cc221ed71b2d6a5f6487c0d93be71c3d.svg)<font style="color:rgb(0, 0, 0);">(mod N)</font>

<font style="color:rgb(0, 0, 0);">å½“må¾ˆå°çš„æ—¶å€™ mçš„eæ¬¡æ–¹å°äºn</font>

<font style="color:rgb(0, 0, 0);">æ‰€ä»¥ c å°±ç­‰äº mçš„eæ¬¡æ–¹ æ­¤æ—¶æˆ‘ä»¬åªè¦å°† c å¼€ e æ¬¡æ–¹å°±å¯ä»¥å¾—åˆ° m</font>

<font style="color:rgb(0, 0, 0);">è¿™é‡Œä½¿ç”¨ gmpy2 åº“çš„irootå¼€æ–¹</font>

```python
from Crypto.Util.number import *
from gmpy2 import *
n  = 536410484994483033093334003836655729325470269375524009439921349251765426879326472420715343135213685847853149465047363004844978980705334818310367627899054282724091430760574321302693735313741776534635308880108579425210969875273787315835179223662471838419622222586196334875552681127482220681804218077447446727632367288719418398225173584249649494060944903031644643599350735559974998992685357629587918116319437983541031003274274249512385723959144711034887286740398048911255492577006594659820438597055144909808217806214389981467817007584648955570726162669186034727073111376869516381199706615431972535815322666741187757365776611420640881256943303112723909875163327558585208160248953717008905206187852681531673607531360656420914879152163720617911529983435735678874123738624814506966909449518581239944997840945458848686624613184987748822188025864390108649415309566456540845277892075600527410134107469406816659137099034223840641145291291677316961839250222786771084598108203101897949775024306470936804403534408830935782941709356062377127100322538567707179546810871854386057481906331948667458888491116697493079241029509563403449393692443545157249665866189068291745976311888965264882340009888119575540460672793226773934767675512684750592502994661
e = 47
c = 229899396883582392364871905906445296949203163435377967308523386636507105732351552139686055293875453912112843930875659740397422297275613832964886182478284228932337946906215427434632071627272673570051303664678550765869183098488754645162034875760803916176659931431903280877040008151839312486086810338837714295821068677830038145047288362507454852643283361570635475479731085221630599511037989875119938896391192076787426053096532792131784563523065082875308622036981017576697767085294161885999051064464805324234829382111945083257918268260979566515252826957333562648074716098524243209378279602403795364197351006272703919005850152191380237640254523031072133802051271379417062521178212883200712566363108988562038188056490055724405896019781505695009412712690784013380990981185039802898643638127923786296260202685639474550000877637714438089700174399902960859666510114240835250541384360368049671274643421485904308653603924744567918821295775350084960806905039253932125210810019431964659889918601526879604439206186643987785399968027152305034576184766368079201408412844596024313611950909884330051927770353597750655703028328638756559133666564620074677469304330050449745861462898383722361080035329755112868572844306365995005218909407333254086037  

m = iroot(c, e)

print(long_to_bytes(m[0]))
```

#### <font style="color:rgb(0, 0, 0);">ä½åŠ å¯†æŒ‡æ•°æ”»å‡»</font>
ç”± â…  æ¶ˆå»æ¨¡ å¾—åˆ° ![image](https://cdn.nlark.com/yuque/__latex/5408886ac0518174dec52ede9a1a5951.svg)= c + k*n

å½“eå¾ˆå°çš„æ—¶å€™ æˆ‘ä»¬å¯ä»¥çˆ†ç ´k å¾—åˆ°æ­£ç¡®çš„ ![image](https://cdn.nlark.com/yuque/__latex/5408886ac0518174dec52ede9a1a5951.svg)

```python
from Crypto.Util.number import *
from gmpy2 import *
n = 25066689877776679233022203369122860358311144108034322786249336304184718167290635002070039262490792542129164733263246201499413220464411226682235152645481523633440451076347588502189820875766207732385081347542902014379448935897761402426197951109899225264278881605284920398145164965059125758041113782043
e = 5
c = 9580937997026657207695606535792321409809664111257153374644767194117132680120146044970386750643915697649050660680091489013318267184823888266207920970701381149337870449324937658700572686851552653818796958133992739190614740958850104564209920508542730206551286453342339610980738869413911612550009452577
for k in range(100000):
    me = c + k*n
    res = iroot(me, e) # irootè¿”å› ä¸€ä¸ªå…ƒç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ•´æ•°çš„æ•´æ•°æ ¹ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ˜¯æ•´æ•°æ ¹
    if res[1]:
        m = res[0]
        break
print(long_to_bytes(m))
```

#### <font style="color:rgb(0, 0, 0);">Rabinç®—æ³•æ”»å‡»</font>
ä¸€ä¸ªæ˜¾è‘—çš„ç‰¹å¾ eä¸º2

```python
from Crypto.Util.number import *
from gmpy2 import *

p = 
q = 
e = 2
c = 

def rabin_attack(c, n, p, q):
    c1 = powmod(c, (p+1)//4, p)
    c2 = powmod(c, (q+1)//4, q)
    cp1 = p - c1
    cp2 = q - c2

    t1 = invert(p, q)
    t2 = invert(q, p)

    m1 = (q*c1*c2 + p*c2*t1) % n
    m2 = (q*c1*t2 + p*cp2*t1) % n
    m3 = (q*cp1*t2 + p*c2*t1) % n
    m4 = (q*cp1*t2 + p*cp2*t1) % n

    return m1, m2, m3, m4

ms = rabin_attack(c, p*q, p, q)

for m in ms:
    print(long_to_bytes(m))
```

#### <font style="color:rgb(0, 0, 0);">Wieneræ”»å‡»</font>
[https://github.com/pablocelayes/rsa-wiener-attack](https://github.com/pablocelayes/rsa-wiener-attack)

```python
from Crypto.Util.number import *
from gmpy2 import *

n = 
e = 
c = 

class ContinuedFraction():
    def __init__(self, numerator, denumerator):
        self.numberlist = []  
        self.fractionlist = []  
        self.GenerateNumberList(numerator, denumerator)
        self.GenerateFractionList()

    def GenerateNumberList(self, numerator, denumerator):
        while numerator != 1:
            quotient = numerator // denumerator
            remainder = numerator % denumerator
            self.numberlist.append(quotient)
            numerator = denumerator
            denumerator = remainder

    def GenerateFractionList(self):
        self.fractionlist.append([self.numberlist[0], 1])
        for i in range(1, len(self.numberlist)):
            numerator = self.numberlist[i]
            denumerator = 1
            for j in range(i):
                temp = numerator
                numerator = denumerator + numerator * self.numberlist[i - j - 1]
                denumerator = temp
            self.fractionlist.append([numerator, denumerator])


a = ContinuedFraction(e, n)
for k, d in a.fractionlist:
    m = powmod(c, d, n)
    flag = long_to_bytes(m)
    
    if b'flag' in flag:  #æ ¹æ®å…·ä½“çš„flagå¤´æ›´æ”¹
        print(flag)
```

#### <font style="color:rgb(0, 0, 0);">ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»</font>
<font style="color:rgb(51, 51, 51);">å½“æœ‰å¤šç»„nï¼Œcçš„æ—¶å€™ï¼Œä¸”eå°</font>

```python
import libnum
from gmpy2 import invert, gcd, iroot

def op(x):
    res = 1
    for i in x:
        res *= i
    return res

def CRT(m, a):
    assert (len(m) == len(a))
    M = op(m)
    sum = 0
    for m, a in zip(m, a):
        Mi = M // m
        ti = invert(Mi, m)
        sum += a * ti * Mi
    return sum % M
def GCRT(m, a):
    assert (len(m) == len(a))
    curm, cura = m[0], a[0]
    for m, a in zip(m[1:], a[1:]):
        d = gcd(curm, m)
        c = a - cura
        assert (c % d == 0)
        K = c // d * invert(curm // d, m // d)
        cura += curm * K
        curm = curm * m // d
    return cura % curm

e= 23
n= [, , , , , , ]
c= [, , , , , , ]

m = CRT(n, c)
m1 = iroot(m, e)  # å¼€eæ¬¡æ–¹
print(m1)
print(libnum.n2s(int(m1[0])))
```

#### <font style="color:rgb(0, 0, 0);">p-1å…‰æ»‘æ”»å‡»</font>
<font style="color:rgb(51, 51, 51);">å…‰æ»‘æ•°ï¼šæŒ‡å¯ä»¥åˆ†è§£ä¸ºå°ç´ æ•°ä¹˜ç§¯çš„æ­£æ•´æ•°</font>

```python
from Crypto.Util.number import *
from gmpy2 import *
n =
e = 65537
c = 
a = 2
m = 2
while True:
    a = powmod(a, m, n)
    p = gcd(a-1, n)
    if p != 1 and p != n:
        break
    m += 1
print(p)
q = n // p

phi = (p-1)*(q-1)
d = invert(e, phi)
m = powmod(c, d, n)
print(long_to_bytes(m))
```

#### <font style="color:rgb(0, 0, 0);">p+1å…‰æ»‘æ”»å‡»</font>

```python
from Crypto.Util.number import *
from gmpy2 import *
from itertools import count

n = 
e = 65537
c = 

def mlucas(v, a, n):
    v1, v2 = v, (v ** 2 - 2) % n
    for bit in bin(a)[3:]: v1, v2 = ((v1 ** 2 - 2) % n, (v1 * v2 - v) % n) if bit == "0" else (
        (v1 * v2 - v) % n, (v2 ** 2 - 2) % n)
    return v1

def primegen():
    yield 2
    yield 3
    yield 5
    yield 7
    yield 11
    yield 13
    ps = primegen()  # yay recursion
    p = ps.__next__() and ps.__next__()
    q, sieve, n = p ** 2, {}, 13
    while True:
        if n not in sieve:
            if n < q:
                yield n
            else:
                next, step = q + 2 * p, 2 * p
                while next in sieve:
                    next += step
                sieve[next] = step
                p = ps.__next__()
                q = p ** 2
        else:
            step = sieve.pop(n)
            next = n + step
            while next in sieve:
                next += step
            sieve[next] = step
        n += 2

def ilog(x, b):  # greatest integer l such that b**l <= x.
    l = 0
    while x >= b:
        x /= b
        l += 1
    return l

def attack(n):
    for v in count(1):
        for p in primegen():
            e = ilog(isqrt(n), p)
            if e == 0:
                break
            for _ in range(e):
                v = mlucas(v, p, n)
            g = gcd(v - 2, n)
            if 1 < g < n:
                return int(g), int(n // g)  # g|n
            if g == n:
                break

p, q = attack(n)


phi = (p-1)*(q-1)
d = invert(e, phi)
m = powmod(c, d, n)
print(long_to_bytes(m))
```

#### <font style="color:rgb(0, 0, 0);">å…±æ¨¡æ”»å‡»</font>
é¢˜ç›®ç»™å‡ºä¸¤å¯¹e c å…¬ç”¨åŒä¸€ä¸ªn

```python
from gmpy2 import *
from Crypto.Util.number import *

n = 

e1 = 
e2 = 

c1 = 
c2 = 

_, s1, s2 = gcdext(e1, e2)

m = powmod(c1, s1, n) * powmod(c2, s2, n) % n
print(long_to_bytes(m))
```

#### <font style="color:rgb(0, 0, 0);">dp&dqæ³„éœ²æ”»å‡»</font>

```python
import gmpy2
import libnum
def decrypt(dp,dq,p,q,c):
    InvQ = gmpy2.invert(q, p)
    mp = pow(c, dp, p)
    mq = pow(c, dq, q)
    m = (((mp-mq)*InvQ) % p)*q+mq
    print(libnum.n2s(int(m)).decode())
p= 
q= 
dq= 
dp= 
c= 
decrypt(dp,dq,p,q,c) 
```

#### <font style="color:rgb(0, 0, 0);">dpæ³„éœ²æ”»å‡»</font>

```python
import libnum
import gmpy2
n= 
e= 65537
dp= 
c= 
for i in range(1,65535):
    p=(dp*e-1)//i+1
    if n%p==0:
        q=n//p
        break
phi_n= (p-1)*(q-1)
d=gmpy2.invert(e,phi_n)
m=pow(c,d,n)
print(m)
flag=libnum.n2s(int(m)).decode()
print(flag)
```

#### <font style="color:rgb(0, 0, 0);">eå¾ˆå¤§çš„dpæ³„éœ²æ”»å‡»</font>

```python
from Crypto.Util.number import *
from gmpy2 import *

n = 
e = 
c = 
dp = 

m = #éšæœº
p = gcd(powmod(m, e*dp, n) - m, n)
q = n // p
d = invert(e, (p - 1) * (q - 1))
m = powmod(c, d, n)
print(long_to_bytes(m))
```

#### <font style="color:rgb(0, 0, 0);">å·²çŸ¥æ˜æ–‡é«˜ä½æ”»å‡»</font>
éœ€è¦sage

[https://mirrors.aliyun.com/sagemath/win/index.html](https://mirrors.aliyun.com/sagemath/win/index.html)

mé«˜ä½å·²çŸ¥

```python
import libnum
def phase2(high_m, n, c):
    R.<x> = PolynomialRing(Zmod(n), implementation='NTL')
    m = high_m + x
    M = m((m^3 - c).small_roots()[0])
    print(libnum.n2s(int(M)))
n= 
e= 3
c= 
high_m= 

phase2(high_m, n, c) 
```

#### <font style="color:rgb(0, 0, 0);">å·²çŸ¥pé«˜ä½æ”»å‡»</font>
éœ€è¦sage

```python
n = 
p4=
e = 0x10001
pbits = 1024
kbits = pbits - p4.nbits()
print(p4.nbits())
p4 = p4 << kbits
PR.<x> = PolynomialRing(Zmod(n))
f = x + p4
roots = f.small_roots(X=2^kbits, beta=0.4)
if roots:
    p = p4+int(roots[0])
    print (n)
    print (p)
    print (n/p)
```

#### <font style="color:rgb(0, 0, 0);">AMMç®—æ³•</font>
å¥½æ–‡ç« [https://xz.aliyun.com/news/13908](https://xz.aliyun.com/news/13908)

```python

from Crypto.Util.number import *
from gmpy2 import *
import random
import math

n = 
c = 
p =    
q = 
e = 

def onemod(e, q):
    p = random.randint(1, q-1)
    while(powmod(p, (q-1)//e, q) == 1):  # (r,s)=1
        p = random.randint(1, q)
    return p

def AMM_rth(o, r, q):  # r|(q-1
    assert((q-1) % r == 0)
    p = onemod(r, q)

    t = 0
    s = q-1
    while(s % r == 0):
        s = s//r
        t += 1
    k = 1
    while((s*k+1) % r != 0):
        k += 1
    alp = (s*k+1)//r

    a = powmod(p, r**(t-1)*s, q)
    b = powmod(o, r*a-1, q)
    c = powmod(p, s, q)
    h = 1

    for i in range(1, t-1):
        d = powmod(int(b), r**(t-1-i), q)
        if d == 1:
            j = 0
        else:
            j = (-math.log(d, a)) % r
        b = (b*(c**(r*j))) % q
        h = (h*c**j) % q
        c = (c*r) % q
    result = (powmod(o, alp, q)*h)
    return result

def ALL_Solution(m, q, rt, cq, e):
    mp = []
    for pr in rt:
        r = (pr*m) % q
        # assert(pow(r, e, q) == cq)
        mp.append(r)
    return mp


def calc(mp, mq, e, p, q):
    i = 1
    j = 1
    t1 = invert(q, p)
    t2 = invert(p, q)
    for mp1 in mp:
        for mq1 in mq:
            j += 1
            if j % 100000 == 0:
                print(j)
            ans = (mp1*t1*q+mq1*t2*p) % (p*q)
            if check(ans):
                return
    return


def check(m):
    try:
        a = long_to_bytes(m)
        if b'NSSCTF' in a:
            print(a)
            return True
        else:
            return False
    except:
        return False


def ALL_ROOT2(r, q):  # use function set() and .add() ensure that the generated elements are not repeated
    li = set()
    while(len(li) < r):
        p = powmod(random.randint(1, q-1), (q-1)//r, q)
        li.add(p)
    return li

cp = c % p
cq = c % q

mp = AMM_rth(cp, e, p)  # AMMç®—æ³•å¾—åˆ°ä¸€ä¸ªè§£
mq = AMM_rth(cq, e, q)

rt1 = ALL_ROOT2(e, p)  # å¾—åˆ°æ‰€æœ‰çš„riï¼Œå³(ri*mp)^e%p = 1
rt2 = ALL_ROOT2(e, q)

amp = ALL_Solution(mp, p, rt1, cp, e)  # å¾—åˆ°æ‰€æœ‰çš„mp
amq = ALL_Solution(mq, q, rt2, cq, e)

calc(amp, amq, e, p, q)  # ä¿©ä¿©CRT
```

#### <font style="color:rgb(51, 51, 51);">å‰ªæ</font>
<font style="color:rgb(51, 51, 51);">a1^b1ï¼š</font>

```python
from Crypto.Util.number import *
import sys

sys.setrecursionlimit(1500)

# part1,å‰ªæ
a1 = 
b1 = 
c1 = 
e = 65537
a1 = "0" + str(bin(a1)[2:])


def find(p, q):
    l = len(p)
    tmp0 = p + (1024 - l) * "0"
    tmp1 = p + (1024 - l) * "1"
    tmq0 = q + (1024 - l) * "0"
    tmq1 = q + (1024 - l) * "1"
    if (int(tmp0, 2) < int(tmq0, 2)):
        return
    if (int(tmp0, 2) * int(tmq0, 2) > b1):
        return
    elif (int(tmp1, 2) * int(tmq1, 2) < b1):
        return

    if (l == 1024):
        pp = int(tmp0, 2)
        qq = int(tmq0, 2)
        d = inverse(e, (pp - 1) * (qq - 1))
        m = long_to_bytes(pow(c1, d, pp * qq))
        print(str(m)[2:-1], end="")

    else:
        if (a1[l] == "1"):
            find(p + "1", q + "0")
            find(p + "0", q + "1")
        else:
            find(p + "0", q + "0")
            find(p + "1", q + "1")


tempp = ""
tempq = ""
find(tempp, tempq)
```

<font style="color:rgb(51, 51, 51);">p ^ _qï¼š</font>

<font style="color:rgb(51, 51, 51);">pä¸qçš„åæ–¹å‘äºŒè¿›åˆ¶çš„å¼‚æˆ–å€¼</font>

```python
from Crypto.Util.number import *
import sys
sys.setrecursionlimit(1500)

pxorq = 
n =
c = 
e = 65537
pxorq = str(bin(pxorq)[2:]).zfill(256)
 
def find(ph,qh,pl,ql):
    l = len(ph)
    tmp0 = ph + (256-2*l)*"0" + pl
    tmp1 = ph + (256-2*l)*"1" + pl
    tmq0 = qh + (256-2*l)*"0" + ql
    tmq1 = qh + (256-2*l)*"1" + ql
    if(int(tmp0,2)*int(tmq0,2) > n):
        return 
    if(int(tmp1,2)*int(tmq1,2) < n):
        return
    if(int(pl,2)*int(ql,2) % (2**(l-1)) != n % (2**(l-1))):
        return

    if(l == 128):
        pp0 = int(tmp0,2)
        if(n % pp0 == 0):
            pf = pp0
            qf = n//pp0
            phi = (pf-1)*(qf-1)
            d = inverse(e,phi)
            m1 = pow(c,d,n)
            print(long_to_bytes(m1))
            exit()

    else:
        if(pxorq[l] == "1" and pxorq[255-l] == "1"):
            find(ph+"1",qh+"0","1"+pl,"0"+ql)
            find(ph+"0",qh+"0","1"+pl,"1"+ql)
            find(ph+"1",qh+"1","0"+pl,"0"+ql)
            find(ph+"0",qh+"1","0"+pl,"1"+ql)
        elif(pxorq[l] == "1" and pxorq[255-l] == "0"):
            find(ph+"1",qh+"0","0"+pl,"0"+ql)
            find(ph+"0",qh+"0","0"+pl,"1"+ql)
            find(ph+"1",qh+"1","1"+pl,"0"+ql)
            find(ph+"0",qh+"1","1"+pl,"1"+ql)
        elif(pxorq[l] == "0" and pxorq[255-l] == "1"):
            find(ph+"0",qh+"0","1"+pl,"0"+ql)
            find(ph+"0",qh+"1","0"+pl,"0"+ql)
            find(ph+"1",qh+"0","1"+pl,"1"+ql)
            find(ph+"1",qh+"1","0"+pl,"1"+ql)
        elif(pxorq[l] == "0" and pxorq[255-l] == "0"):
            find(ph+"0",qh+"0","0"+pl,"0"+ql)
            find(ph+"1",qh+"0","0"+pl,"1"+ql)
            find(ph+"0",qh+"1","1"+pl,"0"+ql)
            find(ph+"1",qh+"1","1"+pl,"1"+ql)

find("1","1","1","1")
```

## <font style="color:rgb(79, 79, 79);">DSA</font>

### åŸç†åŠåŠ è§£å¯†è¿‡ç¨‹
[https://zh.wikipedia.org/wiki/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95](https://zh.wikipedia.org/wiki/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95)

## <font style="color:rgb(79, 79, 79);">ECC</font>

### åŸç†åŠåŠ è§£å¯†è¿‡ç¨‹

## <font style="color:rgb(79, 79, 79);">AES/DES</font>

## ......

## è„šæœ¬:

```python
#!/bin/bash
# ä½œä¸ºmiscçš„é€šç”¨tools
# huihuilikaile 20250425



# è®¾ç½®é¢œè‰²ä¿¡æ¯
# åŸºæœ¬æ–‡å­—é¢œè‰²
BLACK_TEXT="\033[30m"
RED_TEXT="\033[31m"
GREEN_TEXT="\033[32m"
YELLOW_TEXT="\033[33m"
BLUE_TEXT="\033[34m"
PURPLE_TEXT="\033[35m"
CYAN_TEXT="\033[36m"
WHITE_TEXT="\033[37m"

# åŸºæœ¬èƒŒæ™¯é¢œè‰²
BLACK_BG="\033[40m"
RED_BG="\033[41m"
GREEN_BG="\033[42m"
YELLOW_BG="\033[43m"
BLUE_BG="\033[44m"
PURPLE_BG="\033[45m"
CYAN_BG="\033[46m"
WHITE_BG="\033[47m"

# äº®è‰²æ–‡å­—é¢œè‰²
BRIGHT_BLACK_TEXT="\033[1;30m"
BRIGHT_RED_TEXT="\033[1;31m"
BRIGHT_GREEN_TEXT="\033[1;32m"
BRIGHT_YELLOW_TEXT="\033[1;33m"
BRIGHT_BLUE_TEXT="\033[1;34m"
BRIGHT_PURPLE_TEXT="\033[1;35m"
BRIGHT_CYAN_TEXT="\033[1;36m"
BRIGHT_WHITE_TEXT="\033[1;37m"

# è‡ªå®šä¹‰ RGB é¢œè‰²
CUSTOM_RED_TEXT="\033[38;2;255;0;0m"
CUSTOM_GREEN_BG="\033[48;2;0;255;0m"

# ç»„åˆèƒŒæ™¯é¢œè‰²

GREEN_WHITE_TEXT="\033[1;47;32m"
BLUE_WHITE_TEXT="\033[1;34;47m"
BLUE_GREE_TEXT="\033[34;42m"
# é‡ç½®é¢œè‰²
RESET="\033[0m"

# è®¾ç½®é¢œè‰²å‡½æ•°

RED_B() {
    echo "${RED_TEXT}${1}${RESET}\n"
}

BLUE_B() {
    echo "${BLUE_TEXT}${1}${RESET}\n"
}

RED_LB() {
    echo "${BRIGHT_RED_TEXT}${1}${RESET}\n"
}

BLUE_LB() {
    echo "${BRIGHT_BLUE_TEXT}${1}${RESET}\n"
}

ALL_B() {
    echo "${BLUE_WHITE_TEXT}${1}${RESET}\n"
}

BLUE_GREE_B() {
    echo "${BLUE_GREE_TEXT}${1}${RESET}\n"
}

FENGE() {
    echo "${GREEN_TEXT}${1}${RESET}\n"
}

# è®¾ç½®å¸®åŠ©ä¿¡æ¯
usage() {
    echo "Usage: $0 [-f <arg>] [-p <arg>] [-j <arg>] [-g <arg>] [-h]"
    echo "  -f filename  æä¾›æ–‡ä»¶çš„ç±»å‹,EXIF,å…³é”®å­—æ£€æµ‹,æ–‡ä»¶éšè—(binwalk foremost)ç­‰ä¿¡æ¯"
    echo "  -p True/T/t  è¿›è¡Œpngç›¸å…³çš„æ£€æµ‹ "
    echo "  -j key  è¿›è¡Œjpgç›¸å…³çš„æ£€æµ‹ "
    echo "  -g True/T/t  è¿›è¡Œgifç›¸å…³çš„æ£€æµ‹ "
    echo "  -h è·å–å¸®åŠ©"
    exit 1
}


# ANSI è½¬ä¹‰ç å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[0;33m'
BLUE='\033[0;34m'
NC='\033[0m' # é‡ç½®é¢œè‰²

# å‡½æ•°ï¼šå°†æ–‡æœ¬æ·»åŠ å¸¦é¢œè‰²çš„è¾¹æ¡†
add_colored_border() {
  local text="$1"
  local length=${#text}
  
  # è®¡ç®—è¾¹æ¡†å®½åº¦ï¼ˆå¢åŠ ä¸€äº›é¢å¤–çš„ç©ºé—´ï¼‰
  local border_width=$((length + 4))
  
  # æ‰“å°ä¸Šè¾¹æ¡†
  printf "${BLUE_TEXT}+%0.s-" $(seq 1 $border_width)
  echo "--${NC}"
  
  # æ‰“å°æ–‡æœ¬è¡Œ
  printf "${colBLUE_TEXTor} %s ${NC}\n" "$text"
  
  # æ‰“å°ä¸‹è¾¹æ¡†
  printf "${BLUE_TEXT}+%0.s-" $(seq 1 $border_width)
  echo "--${NC}"
}

# å…³é”®å­—

CHARKEY="flag|FLAG|pass|pk|PK|Pk|ctf|CTF|KEY|key|txt|PASS"

# ç›®å½•è®¾ç½®

binwalkout="binwalkoutfile"

foremostout="foremostoutfile"

# å­—ç¬¦åŒ¹é…å‡½æ•°
grep_file() {
    outkeys=$(strings "${1}" | grep "-E" "${CHARKEY}")
    add_colored_border $outkeys
}
# æ–‡ä»¶ç±»å‹åŒ¹é…
file_type() {
    file $1
}

# exifæ•°æ®
exif_file() {
    exiftool "$1"
}



forf() {
    timefile=$(date +"%H%M%S")
    filename="${foremostout}/${timefile}_${1%%.*}"
    if [ -d $filename ]; then
        RED_LB "${RED_TEXT}ç›®å½•${filename}ä¸ä¸ºç©º,é‡æ–°åˆ›å»º:${RESET}"
        timefile=$(date +"%H%M%S")
        filename="${foremostout}/${timefile}_${1%%.*}"
        mkdir $filename
        BLUE_LB "æ–°ç›®å½•:${filename}"
        foremost "-i" "$1" "-o" "${filename}"
        FENGE "ç›®å½•æ ‘: "
        tree $filename
    else
        mkdir $filename
        
        foremost "-i" "$1" "-o" "${filename}"

        BLUE_LB "\nforemostè¾“å‡ºç›®å½•: ${filename}"

        FENGE "ç›®å½•æ ‘: "
        tree $filename
    fi
}
#------------------å›¾ç‰‡ç›¸å…³---------------------
# OurSecretéšå†™æ£€æµ‹
OurSecret_file() {
    # æ¨¡æ‹Ÿ xxd è¾“å‡º
    xxd_output=$(xxd "-p" $1)

    # å¾…æ¯”å¯¹çš„åå…­è¿›åˆ¶æ•°æ®
    target_hex="9e97ba2a008088c9a370975ba2e499b8c178720f88dddc342b4e7d317fb5e87039a8b84275687191"

    # è¿›è¡Œæ¯”å¯¹
    if echo "$xxd_output" | grep -q "$target_hex"; then
        RED_B "å¯èƒ½å­˜åœ¨OurSecret"
    else
        BLUE_LB "ä¸å­˜åœ¨OurSecretéšå†™"
    fi
}


# è®¾ç½®å‚æ•°é€‰é¡¹
while getopts ":f:p:j:g:b:h" opt; do
    case $opt in
        f)
            # BINWALK FOREMOST STRINGS GREP
            FENGE "-----------------ä¿¡æ¯æ”¶é›†-------------------"
            BLUE_GREE_B "æ–‡ä»¶ç±»å‹æ£€æµ‹:"
            file_type $OPTARG
            BLUE_GREE_B "å…³é”®å­—:"
            grep_file $OPTARG
            BLUE_GREE_B "exifæ•°æ®:"
            exif_file $OPTARG
            BLUE_GREE_B "FOREMOST åˆ†ç¦»ç»“æœ:"
            forf $OPTARG
            f_name="$OPTARG"
            
            ;;
        p)
            PTRUE=true
            FENGE "-----------------PNGç›¸å…³æ£€æµ‹-------------------"
            BLUE_GREE_B "pngå®½é«˜æ£€æµ‹:"
            pnghwout=$(python3 "pnghw.py" "-f" "${f_name}")
            BLUE_LB $pnghwout
            BLUE_GREE_B "png IDATå¿«æ£€æµ‹:"
            pngcheck "-v" "${f_name}"
            
            BLUE_GREE_B "OurSecretéšå†™æ£€æµ‹:"
            OurSecret_file $f_name
            ;;
        j)
            BLUE_GREE_B "OurSecretéšå†™æ£€æµ‹:"
            OurSecret_file $f_name
            BLUE_GREE_B "steghideæœªçŸ¥å¯†ç éšå†™æ£€æµ‹:"
            steghide "extract" "-sf" $f_name
            BLUE_GREE_B "outguesséšå†™æ£€æµ‹:"
            outguess "-k" "$OPTARG" "-r"  $f_name "${f_name%%.*}.txt"
            BLUE_LB "è¾“å‡ºæ–‡ä»¶ä¸ºï¼š${f_name%%.*}.txt"
            ;;
        g)
            BLUE_B "Option c$OPTARG"
            ;;
        g)
            BLUE_B "Option c$OPTARG"
            ;;
	    h)
	        usage
	        ;;
        \?)
            RED_LB "æœªçŸ¥é€‰é¡¹: -$OPTARG" >&2
            ;;
        :)
            RED_LB "æä¾›ç»™ -$OPTARG é€‰é¡¹ä¸€ä¸ªå‚æ•°." >&2
            ;;
    esac
done 
FENGE "-----------------å‚¨å­˜èµ„æ–™-------------------"
cat "www.txt"
if [ "$PTRUE" = true ]; then
    BLUE_GREE_B "æ‰§è¡Œzsteg: "
    zsteg "-a" "$f_name"
fi

```

